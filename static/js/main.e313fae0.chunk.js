(this.webpackJsonpcirlos=this.webpackJsonpcirlos||[]).push([[0],[,,,,,,,,,function(e,t,n){"use strict";n.d(t,"i",(function(){return o})),n.d(t,"h",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"k",(function(){return b})),n.d(t,"l",(function(){return h})),n.d(t,"j",(function(){return v})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return x}));var r=n(0),a=n.n(r),c=n(5),i=n(12),s=n.n(i);function o(){for(var e="",t=0;t<arguments.length;t++){if(typeof arguments[t]===(Array.isArray(arguments[t])&&"boolean"===typeof arguments[t][0]&&"object"))!0===arguments[t][0]?e+=arguments[t][1]:arguments[t][2]&&(e+=arguments[t][2]);else e+=arguments[t];e+=" "}return e.trim()}function u(){return Math.random().toString(36).substr(7)}function l(e){return e.split(/\s/).slice(0,2).map((function(e){return e[0]})).join("").toUpperCase()}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.prependOn,r=void 0===n||n,a=864e5,c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=Math.round(Math.round(Date.now()-e)/a);return i<0?"in the future apparently":0===i?"today":1===i?"yesterday":i<7?(r?"on ":"")+c[e.getDay()]:(r?"on ":"")+e.toLocaleDateString()}function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(t){var n=e.type,r=void 0===n?"*":n,a=s.a.assign(document.createElement("input"),{type:"file",accept:r,style:"display:none",onchange:function(){return t(a.files),document.body.removeChild(a)}});document.body.appendChild(a),a.click()}))}function j(e){return new Promise((function(t){return fetch(e).then((function(e){return e.blob()})).then((function(e){var n=new FileReader;n.onload=function(){return t(n.result)},n.readAsDataURL(e)}))}))}var f={};function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise(function(){var n=Object(c.a)(a.a.mark((function n(r){var c,i,s;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(c=f[e])||void 0===c){n.next=4;break}n.t0=c,n.next=7;break;case 4:return n.next=6,j(e).then((function(t){return f[e]=t}));case 6:n.t0=n.sent;case 7:i=n.t0,(s=Object.assign(new Audio(i),{volume:t})).addEventListener("ended",r),s.play().catch((function(t){return console.error("Error playing sound!",e,t)}));case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}function v(e){return 1024*function(e){return 1024*e}(e)}function p(e){var t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}function m(e){var t,n;if(!e)return"";var r=null!==(t=null===e||void 0===e||null===(n=e.toDate)||void 0===n?void 0:n.call(e))&&void 0!==t?t:e;return"".concat(d(r)," at ").concat(r.toLocaleTimeString("en-US"))}var O={PAGE_UPDATE:"PAGE_UPDATE",LOCAL_USER_UPDATE:"LOCAL_USER_UPDATE",USER_UPDATE:"USER_UPDATE",CIRCLE_UPDATE:"CIRCLE_UPDATE",CIRCLES_UPDATE:"CIRCLES_UPDATE",CIRCLE_UPDATE_GROUPS:"CIRCLE_UPDATE_GROUPS",BATCH_UPDATE_DMS:"BATCH_UPDATE_DMS",GROUP_UPDATE:"GROUP_UPDATE",UPDATE_VOICE_MEMBERS:"UPDATE_VOICE_MEMBERS",UPDATE_CURRENT_CALL:"UPDATE_CURRENT_CALL",DM_UPDATE:"DM_UPDATE",UPDATE_MESSAGE_COUNT:"UPDATE_MESSAGE_COUNT",UPDATE_READ_COUNT:"UPDATE_READ_COUNT",UPDATE_CSS_VAR:"UPDATE_CSS_VAR",BATCH_UPDATE_CSS_VARS:"BATCH_UPDATE_CSS_VARS",UPDATE_SETTING:"UPDATE_SETTING",BATCH_UPDATE_SETTINGS:"BATCH_UPDATE_SETTINGS",MESSAGE_CREATE:"MESSAGE_CREATE",MESSAGE_UPDATE:"MESSAGE_UPDATE",MESSAGE_DELETE:"MESSAGE_DELETE",SEND_MESSAGE:"SEND_MESSAGE",EDIT_MESSAGE:"EDIT_MESSAGE",DELETE_MESSAGE:"DELETE_MESSAGE",CHAT_UPDATE:"CHAT_UPDATE",FETCH_EMOTE:"FETCH_EMOTE",UPDATE_EMOTE_FILTERS:"UPDATE_EMOTE_FILTERS",UPDATE_EMOTE_PACK:"UPDATE_EMOTE_PACK",UPDATE_READS:"UPDATE_READS",UPDATE_TYPING_INDICATORS:"UPDATING_TYPING_INDICATORS",DISPLAY_BANNER_NOTIFICATION:"DISPLAY_BANNER_NOTIFICATION",RTA_ATTACH_FILE:"RTA_ATTACH_FILE",RTA_APPEND_TEXT:"RTA_APPEND_TEXT",RTA_SET_TEXT:"RTA_SET_TEXT"},g={FOLDER:0,TEXT:1,VOICE:2,ANNOUNCEMENTS:3},x={OFFLINE:0,ONLINE:1,AWAY:2,BUSY:3,BOT:100}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(15),a=n(13),c=n(2),i=n(4),s=n(3),o=n.n(s),u=function(){function e(){Object(c.a)(this,e),this._callbacks={}}return Object(i.a)(e,[{key:"subscribe",value:function(e,t){return this._callbacks[e]||(this._callbacks[e]=new Set),this._callbacks[e].add(t),this.unsubscribe.bind(this,e,t)}},{key:"unsubscribe",value:function(e,t){this._callbacks[e]&&this._callbacks[e].delete(t)}},{key:"dispatch",value:function(e){var t=e.type;if(this._callbacks[t]){var n,r=Object(a.a)(this._callbacks[t]);try{for(r.s();!(n=r.n()).done;){(0,n.value)(e)}}catch(c){r.e(c)}finally{r.f()}}}},{key:"useForceUpdater",get:function(){var e=this;return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=o.a.useReducer((function(e){return e+1}),0),i=Object(r.a)(c,2),s=i[1];o.a.useEffect((function(){return e.subscribe(t,(function(e){"function"===typeof n?n(e)&&s():s()}))}),a)}}}]),e}(),l=new u},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return k}));var r,a,c=n(0),i=n.n(c),s=n(5),o=n(8),u=n(2),l=n(4),d=n(10),b=n(11),j=n(12),f=n.n(j),h=n(9),v=n(17),p=n(14),m=n(26),O=n(43),g=n(86),x={SYSTEM:new O.b({id:"SYSTEM",displayName:"System",status:h.c.BOT,avatarUrl:g.a,profileBackgroundNsfw:"https://c.tenor.com/Z6gmDPeM6dgAAAAC/dance-moves.gif",feed:"Giving friendly welcomes and farewells. \u2665"})},y=function(e){Object(d.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getLocalUser",value:function(){return a}},{key:"getUser",value:function(e){var t;return null!==(t=x[e])&&void 0!==t?t:(this.fetchUser(e),x[e]=new O.b({id:e,loading:!0,displayName:"..."}))}},{key:"getUsers",value:function(){return x}},{key:"fetchUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?new Promise((function(n){var r=v.a.createSnapshotListener(v.a.doc("userdata",e),(function(a){var c,i;(null===(c=x[e])||void 0===c?void 0:c.loading)&&delete x[e];var s=a?f.a.extend(null!==(i=x[e])&&void 0!==i?i:new O.b,a):new O.b({id:e,displayName:"Deleted User"});p.b.dispatch({type:h.a.USER_UPDATE,user:s}),t&&r(),n(s)}))})):null}}]),n}(m.a),C=new y(p.b,(r={},Object(o.a)(r,h.a.LOCAL_USER_UPDATE,(function(e){var t=e.user;a=t})),Object(o.a)(r,h.a.USER_UPDATE,(function(e){var t=e.user;x[t.id]=t})),r));function k(){return new Promise(function(){var t=Object(s.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e((function(){var e=C.getLocalUser();if(e)n(e);else{C.addListener((function t(){(e=C.getLocalUser())&&(n(e),C.removeListener(t))}))}}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}t.b=C}).call(this,n(52).setImmediate)},function(e,t,n){"use strict";var r=n(15),a=n(0),c=n.n(a),i=n(5),s=n(18),o=n(2),u=n(4),l=n(84),d=n(65),b=n(66),j=n(49),f=n(3),h=n.n(f),v=n(12),p=n.n(v),m={apiKey:"AIzaSyCWL2SBBGhjsKq922QaI2W6XwDEeFZ-YQY",authDomain:"www.cirlos.net",projectId:"cirlos",storageBucket:"cirlos.appspot.com",messagingSenderId:"624454143510",appId:"1:624454143510:web:beb8a88238bc3b9ea72f37",measurementId:"G-ZYXVMY55WD",tosUrl:"https://www.cirlos.net/terms",privacyPolicyUrl:"https://www.cirlos.net/privacy"};t.a=new(function(){function e(){Object(o.a)(this,e),this.app=Object(l.a)(m),this.auth=Object(d.b)(),this.db=Object(j.g)(),this.storage=Object(b.b)(),this.storageCache={},Object.freeze(this)}return Object(u.a)(e,[{key:"doc",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return j.d.apply(void 0,[this.db].concat(t))}},{key:"collection",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return j.b.apply(void 0,[this.db].concat(t))}},{key:"formatDocument",value:function(e,t){return t?Object(s.a)({_ref:e,_snapshot:t,id:t.id},t.data()):null}},{key:"getDoc",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.e)(t);case 2:if((n=e.sent).exists()){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",this.formatDocument(t,n));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDocs",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var n,r=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.f)(t);case 2:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return r.formatDocument(e.ref,e)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSnapshotListener",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.onReady,c=Object(j.h)(e,(function(r){var i,o=e instanceof j.a?n.formatDocument(e,r):{changes:r.docChanges().map((function(e){return Object(s.a)(Object(s.a)({},e),{},{data:n.formatDocument(e.doc.ref,e.doc)})})),items:r.docs.map((function(e){return n.formatDocument(e.ref,e)}))};o&&(o._unbindListener=c),t(o),null===(i=a)||void 0===i||i(o),a=null}));return c}},{key:"useSnapshot",get:function(){var e=this;return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.processor,s=h.a.useState(void 0),o=Object(r.a)(s,2),u=o[0],l=o[1];return h.a.useEffect((function(){return e.createSnapshotListener(t,function(){var e=Object(i.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"===typeof a){e.next=2;break}return e.abrupt("return",l(t));case 2:if(!Array.isArray(t.items)){e.next=13;break}e.t0=c.a.keys(t.items);case 4:if((e.t1=e.t0()).done){e.next=11;break}return n=e.t1.value,e.next=8,a(t.items[n]);case 8:t.items[n]=e.sent,e.next=4;break;case 11:e.next=16;break;case 13:return e.next=15,a(t);case 15:t=e.sent;case 16:l(t);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n)}),[]),u}}},{key:"serializeObject",value:function(e){return p.a.omit(Object(s.a)({},e),["_ref","_snapshot","_unbindListener","id"])}},{key:"set",value:function(){var e=Object(i.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.i)(t,this.serializeObject(n)).catch((function(e){return console.error('Error setting doc data at "'.concat(t.path,'"\n').concat(e.stack))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(i.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.c)(t).catch((function(e){return console.error('Error deleting doc at "'.concat(t.path,'"\n').concat(e.stack))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(i.a)(c.a.mark((function e(t,n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.j)(t,this.serializeObject(n)).catch((function(e){return console.error('Error updating doc data at "'.concat(t.path,'"\n').concat(e.stack))}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getStorageUrl",value:function(){var e=Object(i.a)(c.a.mark((function e(){var t,n,r,a,i,s,o=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=o.length,n=new Array(t),r=0;r<t;r++)n[r]=o[r];return a=n.join("/"),i=Object(b.c)(this.storage,a),e.next=5,Object(b.a)(i);case 5:return s=e.sent,e.abrupt("return",this.storageCache[a]=s);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"uploadStorage",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var s=r.join("/"),o=Object(b.c)(this.storage,s);return Object(b.d)(o,e).then(function(){var e=Object(i.a)(c.a.mark((function e(n){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=n,e.next=3,t.getStorageUrl.apply(t,r);case 3:return e.t1=e.sent,e.abrupt("return",{result:e.t0,url:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}]),e}())},,,function(e,t,n){"use strict";var r,a=n(8),c=n(0),i=n.n(c),s=n(13),o=n(5),u=n(2),l=n(4),d=n(10),b=n(11),j=n(28),f=n(12),h=n.n(f),v=n(30),p=n(9),m=n(17),O=n(14),g=n(26),x=n(46),y=n(39),C=n(16),k={},E={},S=function(e){Object(d.a)(n,e);var t=Object(b.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getGroup",value:function(e,t){if("*"===e)for(var n in k){var r=k[n][t];if(r)return r}return h.a.get(k,[e,t])}},{key:"getSelectedGroup",value:function(){return"dms"===v.a[0]?this.getGroup("dms",v.a[1]):this.getGroup(v.a[1],v.a[3])}},{key:"getGroups",value:function(e){return k[e]||this.fetchGroups(e),k[e]}},{key:"fetchGroups",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E[t]){e.next=2;break}return e.abrupt("return");case 2:if("dms"!==t){e.next=6;break}return e.next=5,this.fetchDms();case 5:return e.abrupt("return",e.sent);case 6:if(n=y.a.getCircle(t)){e.next=9;break}return e.abrupt("return",console.error("Can't fetch groups for uncached circle with ID \"".concat(t,'"!')));case 9:if(!n.loading){e.next=14;break}return e.next=12,new Promise((function(e){return setTimeout(e,100)}));case 12:e.next=9;break;case 14:return e.abrupt("return",new Promise((function(e){var r=m.a.createSnapshotListener(m.a.collection("circles",t,"groups"),(function(){var r,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=a.items,i=void 0===c?[]:c,o=Object(s.a)(i);try{for(o.s();!(r=o.n()).done;){var u,l,d,b,j,f=r.value,v=h.a.extend(null!==(u=h.a.get(k,[t,f.id]))&&void 0!==u?u:new x.b,f,{parent:null===(l=n.groupPositions)||void 0===l||null===(d=l[f.id])||void 0===d?void 0:d[0],position:null===(b=n.groupPositions)||void 0===b||null===(j=b[f.id])||void 0===j?void 0:j[1]});O.b.dispatch({type:p.a.GROUP_UPDATE,circle:n,group:v})}}catch(m){o.e(m)}finally{o.f()}O.b.dispatch({type:p.a.CIRCLE_UPDATE_GROUPS,circle:n,groups:k[t]}),e(k[t])}));E[t]=r})));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchDms",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=C.b.getLocalUser()){e.next=5;break}return e.next=3,new Promise((function(e){return setTimeout(e,100)}));case 3:e.next=0;break;case 5:return e.abrupt("return",new Promise((function(e){var n=m.a.createSnapshotListener(Object(j.l)(m.a.collection("userdata",t.id,"dms"),Object(j.k)("lastMessageDate","desc")),(function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.items,a=void 0===r?[]:r,c=Object(s.a)(a);try{for(c.s();!(t=c.n()).done;){var i,o=t.value,u=h.a.extend(null!==(i=h.a.get(k,["dms",o.id]))&&void 0!==i?i:new x.a,o,{circleId:"dms",isDm:!0,userId:o.id});O.b.dispatch({type:p.a.DM_UPDATE,group:u,userId:o.id})}}catch(l){c.e(l)}finally{c.f()}O.b.dispatch({type:p.a.BATCH_UPDATE_DMS,groups:k.dms}),e(k.dms)}));E.dms=n})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(g.a),T=new S(O.b,(r={},Object(a.a)(r,p.a.GROUP_UPDATE,(function(e){var t=e.circle,n=e.group;h.a.set(k,[t.id,n.id],n)})),Object(a.a)(r,p.a.DM_UPDATE,(function(e){var t=e.group,n=e.userId;h.a.set(k,["dms",n],t)})),r));t.a=T},,function(e,t,n){"use strict";n.d(t,"f",(function(){return N})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return I})),n.d(t,"e",(function(){return _})),n.d(t,"d",(function(){return D})),n.d(t,"a",(function(){return R}));var r=n(18),a=n(0),c=n.n(a),i=n(19),s=n(2),o=n(4),u=n(10),l=n(11),d=n(15),b=n(5),j=n(3),f=n.n(j),h=(n(97),n(59)),v=n(23),p=n(42),m=n(9),O=n(29),g=(n(104),n(1)),x=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(g.jsx)("a",Object(r.a)(Object(r.a)({className:"LinkWrapper"},this.props),{},{children:this.props.children}))}}]),n}(f.a.Component),y=n(158),C=n(159),k=n(160),E=n(161),S=n(162),T=n(134);function N(e){R.push(e)}function w(){R.pop().catch(console.error.bind(console,"Failed to pop modal!"))}function I(e){return A.apply(this,arguments)}function A(){return(A=Object(b.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.navigator.clipboard.writeText(t);case 3:v.a.showToast(Object(g.jsxs)("span",{children:[Object(g.jsx)("b",{children:t.length>=100?t.substr(0,100)+"...":t})," copied to clipboard"]}),"Success"),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),L({title:"Failed To Copy",description:"Your browser does not support copying to clipboard, you can manually copy here.",value:t});case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}function U(e){var t=e.url,n=e.getSources,r="function"===typeof n?n().filter((function(e){return e})):[t],a=f.a.useState(r.indexOf(t)),c=Object(d.a)(a,2),i=c[0],s=c[1],o=function(e){return r[i+e]?(N(!1),A(!1),s(i+e)):v.a.showToast("No more images in this direction!","Failure")},u=f.a.useState(!1),l=Object(d.a)(u,2),b=l[0],j=l[1],h=f.a.useState(!1),p=Object(d.a)(h,2),N=(p[0],p[1]),w=f.a.useState(!1),I=Object(d.a)(w,2),A=(I[0],I[1]);return Object(g.jsxs)("div",{className:"ImageModal",onClick:function(e){return e.target===e.currentTarget&&R.pop()},children:[Object(g.jsx)("div",{className:Object(m.i)("ImageContainer",[b,"Expanded"]),onMouseDown:R.pop.bind(R),children:Object(g.jsx)("img",{src:r[i],alt:"Image failed to load",onLoad:function(){return N(!0),A(!1)},onError:function(){return N(!0),A(!0)}})}),Object(g.jsxs)("div",{className:"Footer",children:[Object(g.jsxs)("div",{className:Object(m.i)("Button Arrow Left",[!r.length||!i,"Disabled"]),onClick:function(){return o(-1)},children:[Object(g.jsx)(y.a,{}),Object(g.jsx)(O.a,{children:"Previous Image"})]}),Object(g.jsx)("div",{className:"Divider"}),Object(g.jsx)("div",{className:"Filename",children:r[i].split("?")[0].split("/").slice(-1)[0].split("_").slice(-1)[0].replaceAll("%20"," ")}),Object(g.jsx)("div",{className:"Divider"}),Object(g.jsxs)("div",{className:"Button",onClick:function(){return j(!b)},children:[b?Object(g.jsx)(C.a,{}):Object(g.jsx)(k.a,{}),Object(g.jsx)(O.a,{children:b?"Compress":"Expand"})]}),Object(g.jsxs)("div",{className:"Button",children:[Object(g.jsx)(E.a,{}),Object(g.jsx)(O.a,{children:"Copy URL"})]}),Object(g.jsxs)(x,{className:"Button",style:{display:"block",color:"white"},href:r[i],children:[Object(g.jsx)(S.a,{}),Object(g.jsx)(O.a,{children:"Open In Browser"})]}),Object(g.jsx)("div",{className:"Divider"}),Object(g.jsxs)("div",{className:Object(m.i)("Button Arrow Right",[!r.length||i+1>=r.length,"Disabled"]),onClick:function(){return o(1)},children:[Object(g.jsx)(T.a,{}),Object(g.jsx)(O.a,{children:"Next Image"})]})]})]})}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;R.push(Object(g.jsx)(U,{url:e,getSources:t}))}function D(e){return P.apply(this,arguments)}function P(){return(P=Object(b.a)(c.a.mark((function e(t){var n,r,a,i,s,o,u,l,d,b,j,f,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,r=void 0===n?"":n,a=t.description,i=void 0===a?"":a,s=t.yesText,o=void 0===s?"Yes":s,u=t.noText,l=void 0===u?"No":u,d=t.yesColor,b=void 0===d?"var(--busy-color)":d,j=t.noColor,f=void 0===j?"":j,e.next=3,new Promise((function(e){R.push(Object(g.jsxs)("div",{className:"BoolModal PrimaryBg",children:[Object(g.jsx)("div",{className:"Title",dangerouslySetInnerHTML:{__html:r}}),Object(g.jsx)("div",{className:"Description",dangerouslySetInnerHTML:{__html:i}}),Object(g.jsxs)("div",{className:"Footer",children:[Object(g.jsx)("div",{className:"Button TertiaryBg",onClick:function(){return e(!1)},style:{backgroundColor:f},children:l}),Object(g.jsx)("div",{className:"Button TertiaryBg",onClick:function(){return e(!0)},style:{backgroundColor:b},children:o})]})]}))}));case 3:return h=e.sent,R.pop(),e.abrupt("return",h);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return M.apply(this,arguments)}function M(){return M=Object(b.a)(c.a.mark((function e(){var t,n,a,i,s=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:{},n=t.async,a=void 0!==n&&n,e.next=4,new Promise((function(e){R.push(Object(g.jsx)(F,Object(r.a)({resolve:e},t)))}));case 4:return i=e.sent,!a&&R.pop(),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)}))),M.apply(this,arguments)}var R=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(s.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={stack:[],closing:[]},e.handleKey=function(e){"Escape"===e.key&&n.pop()},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){n.instance=this,document.addEventListener("keydown",this.handleKey)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKey)}},{key:"handleBackdropClick",value:function(e){var t;if(e.target===e.currentTarget){var r=this.state.stack;if(r[r.length-1]&&"function"===typeof(null===(t=r[r.length-1].props)||void 0===t?void 0:t.onBackdropClick))return r[r.length-1].props.onBackdropClick();n.pop().catch(console.error.bind(console,"Failed to pop modal!"))}}},{key:"render",value:function(){var e=this,t=this.state,n=t.stack,r=t.closing;return Object(g.jsx)("div",{className:"ModalStack"+(n.length>r.length?" Active":""),children:n.map((function(t,a){return Object(g.jsx)(h.a,{children:Object(g.jsx)("div",{className:"ModalContainer"+(~r.indexOf(t)||a<n.length-1?" Closing":""),onMouseDown:e.handleBackdropClick.bind(e),style:{zIndex:10*a},children:t},a)})}))})}}],[{key:"push",value:function(e){this.instance.setState({stack:[].concat(Object(i.a)(this.instance.state.stack),[e])})}},{key:"pop",value:function(){var e=Object(b.a)(c.a.mark((function e(){var t,n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.instance.state,n=t.stack,r=t.closing,a=n[n.length-1],n.length&&a){e.next=4;break}return e.abrupt("return");case 4:return this.instance.setState({closing:[].concat(Object(i.a)(r),[a])}),e.next=7,new Promise((function(e){return setTimeout(e,150)}));case 7:this.instance.setState({stack:this.instance.state.stack.filter((function(e){return e!==a})),closing:this.instance.state.closing.filter((function(e){return e!==a}))});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(f.a.Component);function F(e){var t=e.title,n=void 0===t?"":t,r=e.description,a=void 0===r?"":r,c=e.yesText,i=void 0===c?"Confirm":c,s=e.noText,o=void 0===s?"Cancel":s,u=e.yesColor,l=void 0===u?"":u,b=e.noColor,j=void 0===b?"":b,h=e.value,v=void 0===h?"":h,m=e.onChange,O=void 0===m?null:m,x=(e.rich,e.resolve),y=e.id,C=f.a.useState(!1),k=Object(d.a)(C,2),E=k[0],S=k[1],T=f.a.useState(!1),N=Object(d.a)(T,2),w=N[0],I=N[1];return Object(g.jsxs)("div",{className:"StringModal PrimaryBg",children:[Object(g.jsx)("div",{className:"Title",dangerouslySetInnerHTML:{__html:n}}),Object(g.jsx)("div",{className:"Description",dangerouslySetInnerHTML:{__html:a}}),Object(g.jsx)("input",{id:y,className:"Field TertiaryBg",defaultValue:v,onChange:O}),Object(g.jsxs)("div",{className:"Footer",children:[Object(g.jsx)("div",{className:"Button TertiaryBg",onClick:function(){return x(null),S(!0)},style:{backgroundColor:j},children:E?Object(g.jsx)(p.a,{}):o}),Object(g.jsx)("div",{className:"Button TertiaryBg",onClick:function(){return x(document.getElementById(y).value),I(!0)},style:{backgroundColor:l},children:w?Object(g.jsx)(p.a,{}):i})]})]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(19),a=n(2),c=n(4),i=n(10),s=n(11),o=n(15),u=n(3),l=n.n(u),d=(n(100),n(9)),b=function(){function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(a.a)(this,e),this.callback=t,this.duration=n,this.remainingTime=n,r&&this.resume()}return Object(c.a)(e,[{key:"resume",value:function(){this.startTime=Date.now(),clearTimeout(this.id),this.id=setTimeout(this.callback,this.remainingTime)}},{key:"pause",value:function(){clearTimeout(this.id),this.remainingTime-=Date.now()-this.startTime}},{key:"end",value:function(){clearTimeout(this.id),this.callback()}}]),e}(),j=n(1);function f(e){var t=e.children,n=e.type,r=e.life,a=e.remove,c=e.callback,i=e.color,s=e.fixedTime,u=void 0!==s&&s,f=function(){m(!0),setTimeout(a,500)},h=l.a.useState(!1),v=Object(o.a)(h,2),p=v[0],m=v[1],O=l.a.useMemo((function(){return new b(f,1e3*r,!1)}),[]),g=l.a.useRef(),x=function(){O.pause(),g.current.style.animationPlayState="paused"},y=function(){O.resume(),g.current.style.animationPlayState="running"};return l.a.useEffect((function(){var e=function(){return!u&&y()},t=function(){return!u&&x()};return window.addEventListener("focus",e),window.addEventListener("blur",t),(u||document.hasFocus())&&y(),function(){window.removeEventListener("focus",e),window.removeEventListener("blur",t)}})),Object(j.jsxs)("div",{className:Object(d.i)("Toast",[p,"Closing"],n),onMouseEnter:u?null:x,onMouseLeave:u?null:y,onClick:c?function(e){c(e),O.end()}:function(){O.end()},style:{cursor:c?"pointer":null,backgroundColor:i},children:[t,Object(j.jsx)("div",{className:"ProgressBarContainer",children:Object(j.jsx)("div",{ref:g,className:"ProgressBar",style:{animationDuration:r+"s"}})})]})}var h=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,c=new Array(r),i=0;i<r;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state={toasts:[]},e}return Object(c.a)(n,[{key:"componentDidMount",value:function(){n.instance=this}},{key:"horizontalStyle",get:function(){return"Center"}},{key:"verticalStyle",get:function(){return"Bottom"}},{key:"render",value:function(){var e,t=this;return Object(j.jsxs)("div",{ref:n.ref,className:Object(d.i)("ToastsContainer",this.horizontalStyle,this.verticalStyle),children:[Object(j.jsx)("div",{className:Object(d.i)("ClearButton",[!!(null===(e=this.state.toasts)||void 0===e?void 0:e.length),"Visible"]),onClick:function(){return t.setState({toasts:[]})},children:Object(j.jsx)("u",{children:"Close all"})}),this.state.toasts]})}}],[{key:"showToast",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=c.callback,s=void 0===i?null:i,o=c.color,u=void 0===o?null:o,b=c.fixedTime,j=void 0!==b&&b,h=l.a.createElement(f,{key:Object(d.h)(),children:e,type:n,life:a,color:u,fixedTime:j,remove:function(){t.instance.setState({toasts:t.instance.state.toasts.filter((function(e){return e!==h}))})},callback:s});return this.instance.setState({toasts:[].concat(Object(r.a)(this.instance.state.toasts),[h])}),h}}]),n}(l.a.Component);h.ref=l.a.createRef()},,function(e,t,n){"use strict";n.d(t,"a",(function(){return D})),n.d(t,"d",(function(){return P})),n.d(t,"e",(function(){return V})),n.d(t,"b",(function(){return z}));var r,a,c,i=n(18),s=n(8),o=n(19),u=n(2),l=n(4),d=n(24),b=n(10),j=n(11),f=n(13),h=n(61),v=n(12),p=n.n(v),m=n(139),O=n(140),g=n(141),x=n(88),y=n(142),C=n(143),k=n(144),E=n(145),S=n(146),T=n(9),N=n(17),w=n(14),I=n(26),A=n(51),U=n(16),_=n(1),D={STRING:"STRING",COLOUR:"COLOUR",BUTTON:"BUTTON",SWITCH:"SWITCH",CUSTOM:"CUSTOM",SLIDER:"SLIDER"},P={account:{__icon:Object(_.jsx)(m.a,{}),profile:{},privacy:{ageVerification:{type:D.CUSTOM,note:"WARNING - If you input a false age and this is discovered, your account will be terminated.",component:function(){return Object(_.jsx)("input",{ref:function(e){var t;return e&&(e.valueAsDate=new Date(null!==(t=Y.getSettingValue("account","privacy","ageVerification"))&&void 0!==t?t:(new Date).toString()))},onInput:function(e){return e.target.valueAsDate&&(e.target.valueAsDate.setHours(24),V.dispatch({type:T.a.UPDATE_SETTING,path:["account","privacy","ageVerification"],value:e.target.valueAsDate.toString()}))},type:"date"})}},showNsfwContent:{type:D.SWITCH,label:"Show NSFW Content",note:Object(_.jsxs)(_.Fragment,{children:["Whether or not NSFW content will be displayed.",Object(_.jsx)("br",{}),"If your account is not age-verified, this setting does nothing."]}),value:!0}},logOut:{$:{type:D.BUTTON,text:"Log Out",color:"var(--busy-color)",action:function(){return Object(h.e)(N.a.auth).then((function(){return window.location.assign("/")}))}}}},appearance:{__icon:Object(_.jsx)(O.a,{}),colors:{},background:{image:{type:D.STRING,label:"Image URL",note:"Must link directly to an image.",value:""},positionX:{type:D.SLIDER,label:"Position X",value:50,step:1,min:0,max:100,renderValue:function(e){return e.toFixed(0)+"%"}},positionY:{type:D.SLIDER,label:"Position Y",value:50,step:1,min:0,max:100,renderValue:function(e){return e.toFixed(0)+"%"}},brightness:{type:D.SLIDER,label:"Brightness",value:75,step:1,min:0,max:100,renderValue:function(e){return e.toFixed(0)+"%"}},blurRadius:{type:D.SLIDER,label:"Blur Radius",value:0,step:1,min:0,max:20,renderValue:function(e){return e.toFixed(0)+"px"}}},iconStyles:{avatarShape:{type:D.SWITCH,label:"Use circular style",value:!1},circleShape:{type:D.SWITCH,label:"Use circular style",value:!1}},otherStyles:{localMessageDirection:{type:D.SWITCH,label:"Display your messages right-to-left",value:!1}}},notifications:{__icon:Object(_.jsx)(g.a,{}),toasts:{},audio:{}},communication:{__icon:Object(_.jsx)(x.a,{}),voice:{},video:{}},emotes:{__icon:Object(_.jsx)(y.a,{}),library:{},store:{}},extensions:{__icon:Object(_.jsx)(C.a,{}),store:{},plugins:{},themes:{},customStyles:{}},miscellaneous:{__icon:Object(_.jsx)(k.a,{}),aboutMe:{},changeLogs:{},developerTools:{}},help:{__icon:Object(_.jsx)(E.a,{}),guides:{},markdownRules:{},shortcutsMap:{}},legal:{__icon:Object(_.jsx)(S.a,{}),guidelines:{},termsOfService:{},privacyPolicy:{},cookiesPolicy:{}},__properties:{}},L={primaryColor:"The primary accent color, used to highlight most elements.",secondaryColor:"The secondary accent color, used to highlight other elements.",txtColor:"The base text color for the app.",primaryBg:"The primary background color, used as the background color for almost everything.",secondaryBg:"The secondary background color, used to highlight some element backgrounds.",tertiaryBg:"The tertiary background color, used to double highlight some element backgrounds."},M=null===(r=(a=document.documentElement).computedStyleMap)||void 0===r?void 0:r.call(a);if(M){var R,F=Object(f.a)(["primaryColor","secondaryColor","txtColor","primaryBg","secondaryBg","tertiaryBg"]);try{for(F.s();!(R=F.n()).done;){var B=R.value,G="--".concat(Object(A.b)(B));P.appearance.colors[B]={type:D.COLOUR,label:Object(T.d)(B),note:L[B],value:M.get(G)[0].trim()}}}catch(K){F.e(K)}finally{F.f()}}var W={},H=function(e){Object(b.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(u.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return e=t.call.apply(t,[this].concat(a)),Object(U.a)().then((function(t){t&&(e._databaseReference=N.a.doc("usersettings",t.id,"v2","properties"),N.a.getDoc(e._databaseReference).then((function(t){e._hasLoaded=!0,V.dispatch({type:T.a.BATCH_UPDATE_SETTINGS,entries:null!==t&&void 0!==t?t:{}})})))})),e._save=p.a.debounce(e._save.bind(Object(d.a)(e)),5e3),e}return Object(l.a)(n,[{key:"_save",value:function(){this._hasLoaded&&N.a.set(this._databaseReference,W).catch((function(e){return console.error("Error saving settings!",e.stack)}))}},{key:"getSettingValue",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t=p.a.flatten(t);var r=p.a.get(P,t);return"undefined"===typeof r?console.error("No setting at path",t.join(".")):p.a.get(W,[].concat(Object(o.a)(t),["value"]),r.value)}}]),n}(I.a),V=new w.a,Y=new H(V,(c={},Object(s.a)(c,T.a.UPDATE_SETTING,(function(e){var t=e.path,n=e.value;p.a.get(P,t)?(p.a.set(W,[].concat(Object(o.a)(t),["value"]),n),Y._save()):console.warn("Invalid setting was passed!",{path:t,value:n})})),Object(s.a)(c,T.a.BATCH_UPDATE_SETTINGS,(function(e){var t=e.entries;p.a.extend(W,t)})),c));function z(){V.useForceUpdater(T.a.UPDATE_SETTING),V.useForceUpdater(T.a.BATCH_UPDATE_SETTINGS);var e=Object(i.a)({"appearance.background.image":function(e){var t,n;return e&&'\n\t\t\t.Core::before,\n\t\t\t.SettingsModal::before {\n\t\t\t\tcontent: "";\n\n\t\t\t\tbackground-image: url("'.concat(e,'");\n\t\t\t\tbackground-position:\n\t\t\t\t\t').concat(null!==(t=Y.getSettingValue("appearance","background","positionX"))&&void 0!==t?t:50,"%\n\t\t\t\t\t").concat(null!==(n=Y.getSettingValue("appearance","background","positionY"))&&void 0!==n?n:50,"%;\n\t\t\t\tbackground-size: cover;\n\n\t\t\t\tposition: fixed;\n\t\t\t\twidth: 100vw;\n\t\t\t\theight: 100vh;\n\n\t\t\t\tz-index: -1000;\n\n\t\t\t\tfilter:\n\t\t\t\t\tbrightness(").concat(Y.getSettingValue("appearance","background","brightness")/100,")\n\t\t\t\t\tblur(").concat(Y.getSettingValue("appearance","background","blurRadius"),"px);\n\t\t\t}\n\n\t\t\t.SettingsModal:before { z-index: 0; }\n\n\t\t\t.MessageGroup, #root .RichTextArea .Renderer {\n\t\t\t\tbackground-color: var(--darken-bg);\n\t\t\t}\n\n\t\t\t.MessageGroup {\n\t\t\t\tborder: none;\n\t\t\t\tmargin-top: 5px;\n\t\t\t}\n\n\t\t\t.Messages {\n\t\t\t\tbackground-color: var(--darken-bg);\n\t\t\t}\n\t\t")},"appearance.iconStyles.avatarShape":function(e){return e&&"\n\t\t\t.AvatarContainer, .AvatarContainer > .Avatar {\n\t\t\t\tborder-radius: 100%;\n\t\t\t}\n\t\t"},"appearance.iconStyles.circleShape":function(e){return e&&"\n\t\t\t.Circle, .Circle > .Icon {\n\t\t\t\tborder-radius: 100%;\n\t\t\t}\n\t\t"},"appearance.otherStyles.localMessageDirection":function(e){return e&&"\n\t\t\t.MessageGroup.LocalUser {\n\t\t\t\tdirection: rtl;\n\t\t\t}\n\n\t\t\t.MessageGroup.LocalUser > .Message {\n\t\t\t\tdirection: ltr;\n\t\t\t\tflex-direction: row-reverse;\n\t\t\t}\n\n\t\t\t.MessageGroup.LocalUser > .Message > .MessageContent {\n\t\t\t\ttext-align: right;\n\t\t\t}\n\t\t"}},Object.keys(P.appearance.colors).reduce((function(e,t){return p.a.set(e,["appearance.colors.".concat(t)],(function(e){return e&&"\n\t\t\t\t:root {\n\t\t\t\t\t--".concat(Object(A.b)(t),": ").concat(e,";\n\t\t\t\t}\n\t\t\t")}))}),{}));return Object(_.jsx)("style",{children:Object.keys(e).map((function(t){return e[t](Y.getSettingValue.apply(Y,Object(o.a)(t.split("."))))||""})).join("\n")})}t.c=Y},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(19),a=n(15),c=n(13),i=n(2),s=n(4),o=n(3),u=n.n(o),l=function(){function e(t,n){var r=this;if(Object(i.a)(this,e),this._listeners=new Set,this._dispatcher=t,"object"===typeof n){var a=function(e){t.subscribe(e,(function(t){var a;!1!==(null===(a=n[e])||void 0===a?void 0:a.call(n,t))&&r.emitChange()}))};for(var c in n)a(c)}this._actionHandlers=n}return Object(s.a)(e,[{key:"emitChange",value:function(){var e,t=Object(c.a)(this._listeners);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}}},{key:"addListener",value:function(e){return this._listeners.add(e)}},{key:"removeListener",value:function(e){return this._listeners.delete(e)}},{key:"useState",get:function(){var e=this;return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=u.a.useState(t(e)),i=Object(a.a)(c,2),s=i[0],o=i[1];return u.a.useEffect((function(){var n=function(){return o(t(e))};return e.addListener(n),function(){e.removeListener(n)}}),[s].concat(Object(r.a)(n))),s}}}]),e}()},function(e,t,n){"use strict";var r,a,c=n(0),i=n.n(c),s=n(15),o=n(5),u=n(24),l=n(18),d=n(2),b=n(4),j=n(10),f=n(11),h=n(3),v=n.n(h),p=n(62),m=n.n(p),O=n(134),g=(n(113),n(59)),x=n(1);var y=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).ref=Object(h.createRef)(),e.docClickEv=function(t){!e.ref.current||e.ref.current.contains(t.target)||document.getElementsByClassName("ContextMenu")[0].contains(t.target)||e.close()},e}return Object(b.a)(n,[{key:"close",value:function(){n.activeWrapper&&n.activeWrapper.setState({menu:null,open:!1})}},{key:"componentDidMount",value:function(){document.addEventListener("click",this.docClickEv)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.docClickEv)}},{key:"render",value:function(){return Object(x.jsx)(g.a,{children:Object(x.jsx)("div",Object(l.a)(Object(l.a)({className:"ContextMenu"},this.props),{},{ref:this.ref,children:this.props.children}))})}}]),n}(v.a.Component);y.Handler=(a=r=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(x.jsx)(g.a,{children:Object(x.jsx)("div",{ref:y.Handler.ref,className:"ContextMenuWrapper MainContextMenuContainer"})})}}]),n}(v.a.Component),r.ref=Object(h.createRef)(),a),y.Wrapper=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={menu:null,open:!1},e.ref=Object(h.createRef)(),e.handleContextMenu=function(t){var n,r,a,c;if("function"===typeof t.preventDefault&&t.preventDefault(),y.activeWrapper){if(e.ref.current.contains(y.activeWrapper.ref.current)&&y.activeWrapper.props.menu!==e.props.menu)return;y.activeWrapper.setState({menu:null,open:!1})}y.activeWrapper=Object(u.a)(e);for(var i=(null===(n=(r=e.props.menu.props).overrideY)||void 0===n?void 0:n.call(r))||t.clientY,s=(null===(a=(c=e.props.menu.props).overrideX)||void 0===a?void 0:a.call(c))||t.clientX;s+200>window.innerWidth;)s-=10;e.setState({menu:m.a.createPortal(Object(x.jsx)("div",Object(l.a)(Object(l.a)({className:"ContextMenuContainer SecondaryBg"},e.publicProps),{},{style:{position:"fixed",top:i,left:s},children:e.props.menu})),y.Handler.ref.current),open:!0})},e}return Object(b.a)(n,[{key:"publicProps",get:function(){return function(e){for(var t=Object.assign({},e),n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var c=0,i=r;c<i.length;c++){delete t[i[c]]}return t}(this.props,"menu","openOnClick","wrapperClassName","overrideX","overrideY")}},{key:"componentDidUpdate",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,c,o,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y.activeWrapper!==this||this.state.open||(y.activeWrapper=null),this.state.open&&this.ref.current&&(a=document.getElementsByClassName("ContextMenuContainer"),c=Object(s.a)(a,1),o=c[0],u=o.getBoundingClientRect(),o.style.transform=u.y+u.height>window.innerHeight?"translateY(".concat(window.innerHeight-(u.y+u.height)-20,"px)"):null);case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.props.menu?Object(x.jsx)(g.a,{children:Object(x.jsxs)("div",Object(l.a)(Object(l.a)({ref:this.ref,className:"ContextMenuWrapper "+(this.props.wrapperClassName||""),onClick:this.props.openOnClick?function(t){"function"!==typeof t.target.onClick&&e.handleContextMenu(e.props.openOnClick())}:null},this.publicProps),{},{onContextMenu:this.handleContextMenu,children:[this.props.children,Object(x.jsx)(g.a,{children:this.state.open?this.state.menu:null})]}))}):this.props.children}}]),n}(v.a.Component),y.Item=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).handleClick=function(t){t.preventDefault(),t.stopPropagation(),y.activeWrapper&&e.props.autoClose&&y.activeWrapper.setState({menu:null,open:!1}),e.props.onClick&&e.props.onClick(Object(u.a)(e))},e}return Object(b.a)(n,[{key:"render",value:function(){var e=Object.assign({},this.props);return delete e.autoClose,delete e.icon,Object(x.jsxs)("div",Object(l.a)(Object(l.a)({className:"ContextMenuItem"},e),{},{onClick:this.handleClick,children:[this.props.icon,this.props.children]}))}}]),n}(v.a.Component),y.SubMenuItem=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={open:!1},e.handleMouseEnter=function(){e.setState({open:!0})},e.handleMouseLeave=function(){e.setState({open:!1})},e.handleClick=function(t){t.target===t.currentTarget&&(y.activeWrapper&&e.props.autoClose&&y.activeWrapper.setState({menu:null,open:!1}),e.props.onClick&&e.props.onClick(Object(u.a)(e)))},e}return Object(b.a)(n,[{key:"mount",value:function(e){if(e){var t=e.getBoundingClientRect();e.style.transform=t.y+t.height>window.innerHeight?"translateY(".concat(window.innerHeight-(t.y+t.height)-20,"px)"):null,t.x+t.width>window.innerWidth&&(e.style.left="unset",e.style.right="100%")}}},{key:"render",value:function(){var e=Object.assign({},this.props);return delete e.autoClose,delete e.label,delete e.icon,Object(x.jsxs)("div",Object(l.a)(Object(l.a)({className:"ContextMenuItem HasSubMenu"},e),{},{onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[this.props.icon,this.props.label," ",Object(x.jsx)(O.a,{className:"ContextSubMenuChevron"}),this.state.open?Object(x.jsx)("div",{className:"ContextMenuContainer SubMenuContainer SecondaryBg",ref:this.mount,children:Object(x.jsx)("div",{className:"ContextMenu SubMenu",children:this.props.children})}):null]}))}}]),n}(v.a.Component),y.ToggleItem=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={checked:!1},e.callback=function(){y.activeWrapper&&e.props.autoClose&&y.activeWrapper.setState({menu:null,open:!1});var t=!e.state.checked;e.props.callback&&e.props.callback(t),e.setState({checked:t})},e}return Object(b.a)(n,[{key:"componentDidMount",value:function(){this.setState({checked:this.props.checked})}},{key:"render",value:function(){var e=Object.assign({},this.props);return delete e.autoClose,delete e.callback,Object(x.jsxs)("div",Object(l.a)(Object(l.a)({className:"ContextMenuItem ToggleItem"},e),{},{onClick:this.callback,children:[Object(x.jsx)("div",{className:"ToggleBox"+(this.state.checked?" Checked":""),children:this.state.checked?Object(x.jsx)("div",{className:"ToggleBoxTick"}):null}),this.props.children]}))}}]),n}(v.a.Component),y.Divider=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"render",value:function(){return Object(x.jsx)("div",Object(l.a)({className:"ContextMenuDivider"},this.props))}}]),n}(v.a.Component),t.a=y},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(18);var r=n(15),a=n(3),c=n.n(a),i=(n(103),n(9)),s=(n(62),n(1));function o(e){var t=e.children,n=void 0===t?null:t,a=e.direction,o=void 0===a?"up":a,u=e.className,l=void 0===u?"":u,d=e.color,b=e.style,j=void 0===b?null:b,f=e.onClick,h=void 0===f?null:f,v=c.a.useState(!1),p=Object(r.a)(v,2),m=p[0],O=(p[1],c.a.useRef());return c.a.useEffect((function(){return O.current.parentElement.classList.add("HasTooltip"),function(){O.current&&O.current.parentElement.classList.remove("HasTooltip")}}),[n,o]),Object(s.jsxs)("div",{ref:O,className:Object(i.i)("TooltipContainer",o.toLowerCase(),[m,"Visible"],l),style:j,onClick:h,children:[Object(s.jsx)("div",{className:"Tooltip",style:{backgroundColor:d},children:n}),Object(s.jsx)("div",{className:"TooltipArrow",style:{backgroundColor:d}})]})}},function(e,t,n){"use strict";n.d(t,"c",(function(){return Ye})),n.d(t,"a",(function(){return ze})),n.d(t,"b",(function(){return Xe}));var r,a,c=n(0),i=n.n(c),s=n(5),o=n(83),u=n(3),l=n.n(u),d=(n(95),n(96),n(22)),b=(n(107),["title","titleId"]);function j(){return j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j.apply(this,arguments)}function f(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function h(e,t){var n=e.title,c=e.titleId,i=f(e,b);return u.createElement("svg",j({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",style:{isolation:"isolate"},viewBox:"0 0 3840 1080",width:"3840pt",height:"1080pt",ref:t,"aria-labelledby":c},i),n?u.createElement("title",{id:c},n):null,r||(r=u.createElement("defs",null,u.createElement("clipPath",{id:"_clipPath_9ysGc3cj8hVy9CQFlwXLbt9IIMadCtby"},u.createElement("rect",{width:3840,height:1080})))),a||(a=u.createElement("g",{clipPath:"url(#_clipPath_9ysGc3cj8hVy9CQFlwXLbt9IIMadCtby)"},u.createElement("path",{d:" M 0 540 Q 440.909 859.091 960 540 Q 1479.091 220.909 1920 540 L 1920 1080 L 0 1080 L 0 540 Z ",fill:"currentColor"}),u.createElement("path",{d:" M 1920 540 Q 2360.909 859.091 2880 540 Q 3399.091 220.909 3840 540 L 3840 1080 L 1920 1080 L 1920 540 Z ",fill:"currentColor"}))))}var v=u.forwardRef(h),p=(n.p,n(171)),m=n(172),O=n(89),g=n(173),x=n(81),y=n(16),C=(n(121),n(167)),k=n(168),E=n(169),S=n(170),T=n(78),N=n.p+"static/media/TwemojiHeart.a32c5071.svg",w=n(29),I=n(1);function A(){var e={website:function(){return window.open("https://metalloriff.github.io/","_blank")},github:function(){return window.open("https://github.com/metalloriff","_blank")},twitter:function(){return window.open("https://twitter.com/Metalloriff","_blank")},email:function(){return window.open("mailto:metalloriff@gmail.com","_blank")},discord:function(){return Object(d.c)("Metalloriff \ud83d\udc95\ud83c\udf08#2891")}};return Object(I.jsx)("footer",{children:Object(I.jsxs)("div",{className:"Flex",children:[Object(I.jsxs)("div",{className:"LeftSections",children:[Object(I.jsxs)("div",{className:"HeadSection FlexCenter",children:[Object(I.jsx)("img",{className:"Logo",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjEuNWRHWFIAAAawSURBVGhD7VlbT1NZFJ4/5SXRTIaQyMOMiWiMRnzQiTo+6ZviMDMoCCMyCgKCgCgqeEHlMgIzVKRyv5QWgTIWaGmhpVBaKJVSoFC+OWvb1racHnpaaYjhS75Auy9nfWfvtdZeu9/dvNSIb4E7QrYbd4RsN0Yk5K/Ed8hLaeFtizYjElKU0Y5R5QxvW7QZkZDy/F6srbrQ8Pojb3s0GZGQZwW96O+exNSEDY9zenj7RIsRCbmf2YHhARPbYjPGBdxLb+PtFw1GJCSTc3bz1AJuXm5EWZ4MpslPyL/eirdVKvaXb8xWMSIhxEGZEc+L5Ox/2mokZrDXiOUlJ+RtE3iY1bVhzFYwYiEPbnVCr7Uik1sV+lzKGT4/54DBYEBSUhKamppg1FswpJhCY80wHt7eGmERCRnhQq9+zArrrAMt/6q93+debYaq34Tu7m4cOnQIe/fuRUJCAlJSUiCRSDAxZmGr+CS3B0+5VfSdM1yGJeSvK+/w6sEH2KxLaHozAu3ILNbX16Ho0Pv5xsv7fdxqzaGhoQEXL17Evn37sGvXLhw8eBDt7e3sJSzYlnHnj/d+84dD0UIK0loxO7OInp4eKJVKlHBbi74vze6G5qMZzpU1tPyjZmI9Y8ruypi/TE3OoqqqCkeOHMGePXvY/zqdDs1cf0/fcBnWirwoUnAGO9Hb24v6F0N+bRX3FZgzL8LEheNAfyA/evWgDwbdHAoLC9mWO3v2LCbH5/z6hUPRQl6W9GFYpca5c+cQHx+PCc1GI24nNUHWMg6ncw2dTVo8utPt105ntL5OA8rLy9lW6+8fYKtIPlf7TOnXN1SKEkLbaFg1itjYWGYAsba2Fn+XD/L2ryhWYHFhBQRKmM8LP4dpIq3OuHoOJ0+eRE1NDROVk5MDq9WK1w8/+M0TCkUJ0Y1acOLECa8I4oEDBzBpmEbxzQ7eMeT8k+PzTIzLtc5tvT5vW9XjfpSWliIuLg7aMT3aJBoWolt9ImCoDFkIhcv6+no/ER7SPp+Zmg96RLn1axMkdV1IT0/HtHEWt7nP9D1tOZPJhOTkZBauA8eJYchCNCozjh8/zivk9OnTsFgsLBxTggwc+0vCdW/furo6FnIpILjW1tlKUeg2cgfPwHFiGJKQ8nwZy9C+xnt44cIFLC8vM4MIK8urqHrU7zc+/sefWd8zZ85gbW3N3XMjuqRadm7zHRsqNxWS/bsUep2Fxf5AEbRCDofDbYY/FO16ZCVJkXHpLWK+j2MBYnp62t0K2Gw25uDXrl1lTk45iaCUG5GT3MxrixAFhdz7sw3jGgsSExM3iKAcMDIywh4eDD2d/Yj94SfWv7q62v3tRpjNZuZ/HjFLjlVI60a9vhQKeYVQnO98p4V5Zha5ubksshw9etRPSGpqKnuoEFZXV3H+/HmcOnWK+YFY2OaW8OYpF9pD2G5BV+QVl/iU8ilYpu1QKBSIiYnxE6LRaNyPE8b8/PymK7cZDLp5dgTis9NDwa11N7UFOq1+gwg6yUYblIOoIuWzkygopLVBg7S0ND8RxPz8fPf00UVlqX809KWgkNEhM4tWu3fvxuHDh71CpFKpe+rIYTQaYbfb3Z+EUVka/OgiKIQuFo4dO8bqCa1W6xUil8vdU0cOl8vF1SZtqKioQHFxEcv+2dlZKCkpgVqtdvf6DCrE+OwkCgqR1o6wo7q8fYIrgma9vtLR0eGeWjxWnS6W2R1256aRTCbr8QYV8hHKaXx2EgWF5F1r5mK6kzk9icrIyGBCKisr2eRiMCCbZJEn8/KXgivrNymGuMhIRxU+TXTkKctvY8UaHTx9bQukoBCip6amclTHnVD379+PGzduuB8VGuglBM7rIeUsaqc6hN66L+yfVlif91xyrK/wL+ACuakQX0oqP6KsrIw5fqiwmOzeG5bN2Fitco/6DM8LoAzvu5J8FCWEDKJTMB0UBwcH3Y8TRvd7He9cwUgXEh5UPx7g7cNHUUKI5Dd6nQkFBQXuxwlDUqXinScYqZQm0DYT85OFaCFEyrD6cRMWFxfZQ4VA+5tvjmAkn6FETLeVfO3BGJYQIr2tMZXFbW5wTOltIfuIh3R5kZMs7q4rbCEe1j5XctHlS2HFh74Ovd8911YwYiFEWh26bRQCRS/6QYhyEt8ckfKrCPGw+skAu/bZDFaLA+r/zPjQaWD3Xi+KFaK3XyC/qhAPn+TJ0MUZSPdW9oUVb6KjIwnV9PSbCmV0SaUKhVwVyjeHWG6JkEBSJKKkdutK6KWrWEZFSDS4I2S7cUfIduM3IqQR/wPMTZmSnhx+ZgAAAABJRU5ErkJggg==",alt:"Logo"}),Object(I.jsxs)("div",{children:[Object(I.jsx)("h2",{children:"Metalloriff"}),Object(I.jsxs)("div",{children:["Made with ",Object(I.jsx)("img",{src:N,alt:"\u2665",width:15,height:15})]})]})]}),Object(I.jsxs)("div",{className:"ContactSection Flex",children:[Object(I.jsxs)("div",{className:"ContactEntry",onClick:e.website,children:[Object(I.jsx)(C.a,{}),Object(I.jsx)(w.a,{children:"Website"})]}),Object(I.jsxs)("div",{className:"ContactEntry",onClick:e.github,children:[Object(I.jsx)(k.a,{}),Object(I.jsx)(w.a,{children:"GitHub"})]}),Object(I.jsxs)("div",{className:"ContactEntry",onClick:e.twitter,children:[Object(I.jsx)(E.a,{}),Object(I.jsx)(w.a,{children:"Twitter"})]}),Object(I.jsxs)("div",{className:"ContactEntry",onClick:e.email,children:[Object(I.jsx)(S.a,{}),Object(I.jsx)(w.a,{children:"Email"})]}),Object(I.jsxs)("div",{className:"ContactEntry",onClick:e.discord,children:[Object(I.jsx)(T.a,{}),Object(I.jsx)(w.a,{children:"Discord"})]})]})]}),Object(I.jsx)("div",{className:"MiddleSection"}),Object(I.jsx)("div",{className:"RightSections FlexCenter",children:Object(I.jsxs)("div",{className:"LinksSection",children:[Object(I.jsx)("a",{href:"#clearlyiforgottoaddthis",children:"Source Code"}),Object(I.jsx)("a",{href:"https://feathericons.com/",children:"Icons Used"}),Object(I.jsx)("a",{href:"https://metalloriff.github.io/city-fog",children:"Color Palette"}),Object(I.jsxs)("a",{href:"https://paypal.me/israelboone",children:[Object(I.jsx)("img",{src:N,alt:"\u2665",width:15,height:15}),Object(I.jsx)("span",{style:{margin:"0 7px"},children:"Donate"}),Object(I.jsx)("img",{src:N,alt:"\u2665",width:15,height:15})]}),Object(I.jsxs)("div",{className:"Copyright",children:["Copyright \xa9 ",(new Date).getFullYear()," Israel Boone"]})]})})]})})}function U(){var e=y.b.useState(y.b.getLocalUser);return Object(I.jsxs)("div",{className:"HomePage",children:[Object(I.jsx)("div",{className:"HomeBackgroundContainer",children:Object(I.jsxs)("div",{className:"HomeBackground",children:[Object(I.jsx)(v,{}),Object(I.jsx)(v,{})]})}),Object(I.jsxs)("div",{className:"Hero",children:[Object(I.jsx)("h1",{children:"Cirlos"}),Object(I.jsxs)("h3",{children:["A simpler way to connect with friends and family,",Object(I.jsx)("br",{}),"with powerful ways to personalize your experience.",Object(I.jsx)("br",{})]}),Object(I.jsxs)("div",{className:"Buttons",children:[null!==e?Object(I.jsx)(l.a.Fragment,{children:Object(I.jsxs)("div",{className:"Button Focus",onClick:function(){return window.location.assign("#app")},children:[Object(I.jsx)(p.a,{}),"Continue To App"]})}):Object(I.jsxs)(l.a.Fragment,{children:[Object(I.jsxs)("div",{className:"Button Focus",onClick:function(){return d.a.push(Object(I.jsx)(x.a,{signUp:!0}))},children:[Object(I.jsx)(m.a,{}),"Sign Up"]}),Object(I.jsxs)("div",{className:"Button",onClick:function(){return d.a.push(Object(I.jsx)(x.a,{}))},children:[Object(I.jsx)(O.a,{}),"Sign In"]})]}),Object(I.jsxs)("div",{className:"Button",children:[Object(I.jsx)(g.a,{}),"Download"]})]})]})]})}var _=n(23),D=n(9),P=n(27),L=n(14),M=n(61),R=n(17),F=n(15),B=n(19),G=n(12),W=n.n(G),H=n(177),V=n(178),Y=n(32),z=n(47),K=n(39),X=n(51),Q=n(20),Z=n(37),q=n(45),J=n(87),$=n(42),ee=n(174),te=n(58);n(123);function ne(){var e;L.b.useForceUpdater(D.a.UPDATE_CURRENT_CALL);var t=q.b.currentRoom;L.b.useForceUpdater(D.a.UPDATE_VOICE_MEMBERS,(function(e){return e.groupId===(null===t||void 0===t?void 0:t.group.id)}));var n=null!==(e=(null===t||void 0===t?void 0:t.group)?te.a.getVoiceMembers(t.group.circleId,t.group.id):[])&&void 0!==e?e:[];return t?Object(I.jsx)("div",{className:"Panel PanelCall",children:Object(I.jsx)("div",{className:"Members FlexCenter",children:n.map((function(e){return Object(I.jsx)(re,{userId:e},e)}))})}):Object(I.jsxs)("div",{className:"Panel PanelCall NoCall",children:[Object(I.jsx)(ee.a,{})," Call ended."]})}function re(e){var t=e.userId,n=y.b.useState((function(){return y.b.getUser(t)}));return n?Object(I.jsxs)("div",{className:"VoiceMember",children:[Object(I.jsx)(n.AvatarComponent,{size:200}),Object(I.jsx)("h4",{className:"Username",children:n.displayName})]}):null}var ae=n(64),ce=n(18);function ie(e){var t=e.children,n=l.a.useRef(),r=l.a.useMemo((function(){return function(e){L.b.dispatch({type:D.a.UPDATE_CSS_VAR,key:"groupPanelSize",value:W.a.clamp(e.clientX-n.current.getBoundingClientRect().x,100,500)})}}),[t]),a={onMouseDown:function(){var e;document.addEventListener("mousemove",r),document.addEventListener("mouseup",e=function(){document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",e)})}};return Object(I.jsxs)("div",{className:"Panel PanelGroups",ref:n,children:[t,Object(I.jsx)("div",Object(ce.a)({className:"GroupsScaler"},a))]})}n(124);function se(e){var t=e.circleId,n=K.a.getCircle(t);y.b.useState((function(){return y.b.getUser(null===n||void 0===n?void 0:n.ownerId)}));return n?Object(I.jsx)("div",{className:"CircleOverview FlexCenter",children:Object(I.jsxs)("div",{className:"Hero FlexCenter",children:[Object(I.jsx)("div",{className:"Circle",onClick:function(){return Object(d.e)(n.iconUrl)},children:n.iconUrl?Object(I.jsx)("img",{className:"Icon",src:n.iconUrl,alt:Object(D.g)(n.name)}):Object(I.jsx)("h3",{className:"Icon Acronym",children:Object(D.g)(n.name)})}),Object(I.jsx)("div",{className:"Banner",children:n.iconUrl&&Object(I.jsx)("img",{className:"BannerImage Default",src:n.iconUrl,alt:"banner"})}),Object(I.jsx)("h1",{className:"Title",children:n.name})]})}):null}n(125);function oe(e){var t=e.circle;function n(){switch(ze[2]){case"groups":return Object(I.jsx)(ae.b,{circleId:t.id,groupId:ze[3]});case"overview":return Object(I.jsx)(se,{circleId:t.id});case"call":return Object(I.jsx)(ne,{})}return null}return L.b.useForceUpdater(D.a.PAGE_UPDATE),L.b.useForceUpdater(D.a.CIRCLE_UPDATE_GROUPS,(function(e){return e.circle.id===t.id}),[t]),Object(I.jsxs)("div",{className:"CirclePage Flex",children:[Object(I.jsx)(ie,{children:t.renderGroups()}),Object(I.jsx)(n,{})]})}n(126);function ue(){L.b.useForceUpdater(D.a.PAGE_UPDATE),L.b.useForceUpdater(D.a.BATCH_UPDATE_DMS);var e,t=Q.a.getGroups("dms");function n(){var e,t;return""===(null!==(e=null===(t=ze[1])||void 0===t?void 0:t.trim())&&void 0!==e?e:"")?null:Object(I.jsx)(ae.b,{circleId:"dms",groupId:ze[1]})}return Object(I.jsxs)("div",{className:"DmsPage Flex",children:[Object(I.jsx)(ie,{children:(e=t,e?Object.values(e).sort((function(e,t){return t.lastMessageDate-e.lastMessageDate})).map((function(e){return Object(I.jsx)(e.Component,{},e.groupId)})):null)}),Object(I.jsx)(n,{})]})}n(127);function le(){switch(L.b.useForceUpdater(D.a.PAGE_UPDATE),ze[0]){case void 0:case"":return Object(I.jsxs)("div",{className:"AppHome FlexCenter",children:[Object(I.jsx)("h2",{children:"Welcome to the new Cirlos!"}),Object(I.jsx)("p",{children:"Cirlos has been completely redesigned and rewritten, from the ground up."}),Object(I.jsx)("p",{children:"This means better UI/UX, stability, and performance."})]});case"circles":var e=K.a.getCircle(ze[1]);return e?Object(I.jsx)(oe,{circle:e}):Object(I.jsxs)("div",{className:"AppHome FlexCenter",children:[Object(I.jsx)("h2",{children:"Oops!"}),Object(I.jsx)("p",{children:"This circle could not be loaded properly."})]});case"dms":return Object(I.jsx)(ue,{})}return Object(I.jsx)("div",{className:"AppHome FlexCenter",children:"This page does not exist."})}var de=n.p+"static/media/alert.7584e772.ogg",be=(n(128),n(25)),je=n(175),fe=n(138),he=n(176);n(129);function ve(e){var t=e.title,n=e.defaultValue,r=e.callback,a=e.note,c=void 0===a?"":a;return Object(I.jsxs)("div",{className:"SwitchItem",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("h4",{className:"Title",children:t}),Object(I.jsx)("div",{className:"Note",children:c})]}),Object(I.jsx)("input",{className:"Switch",type:"checkbox",defaultChecked:n,onInput:function(e){return null===r||void 0===r?void 0:r(e.currentTarget.checked)}})]})}n(130);function pe(){var e=l.a.useState(null),t=Object(F.a)(e,2),n=t[0],r=t[1],a=l.a.useState(1),c=Object(F.a)(a,2),o=c[0],u=c[1],b=l.a.useState(""),j=Object(F.a)(b,2),f=j[0],h=j[1],v=!1;function p(e){return m.apply(this,arguments)}function m(){return(m=Object(s.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=2;break}return e.abrupt("return");case 2:return v=!0,u(0),e.next=6,new Promise((function(e){return setTimeout(e,150)}));case 6:r(t),u(1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O={root:function(e){if(!f)return!0;if(e.toLowerCase().includes(f))return!0;for(var t in be.d[e]){if(O.sub(t))return!0;if(O.items(e,t))return!0}return!1},sub:function(e){return!f||(!!e.toLowerCase().includes(f)||void 0)},items:function(e,t){if(!f)return!0;for(var n in be.d[e][t])if(n.toLowerCase().includes(f))return!0;return!1}};return Object(I.jsxs)("div",{className:"SettingsModal FullScreenModal FlexCenter",children:[Object(I.jsxs)("div",{className:"Inner",children:[Object(I.jsx)("input",{type:"text",className:"SearchField",placeholder:"Search...",onInput:function(e){return h(e.target.value.toLowerCase())}}),Object(I.jsxs)("div",{style:{opacity:o},className:"Contents",children:[!n&&Object(I.jsx)("div",{className:"Categories FlexCenter",children:Object.keys(be.d).filter(O.root).map((function(e){return!e.startsWith("__")&&Object(I.jsxs)("div",{className:"CategoryBubble",onClick:function(){return p(e)},children:[Object(I.jsxs)("div",{className:"FlexCenter",children:[be.d[e].__icon,Object(I.jsx)("h4",{className:"Title",children:Object(D.d)(e)})]}),Object(I.jsx)("div",{className:"Sections",children:Object.keys(be.d[e]).map((function(e){return Object(D.d)(e).toLowerCase()})).filter((function(e){return!e.startsWith("__")})).join(", ")})]},e)}))}),n&&Object(I.jsxs)(l.a.Fragment,{children:[Object(I.jsx)("div",{className:"Categories FlexCenter BackButton",children:Object(I.jsx)("div",{className:"CategoryBubble",onClick:function(){return p(null)},children:Object(I.jsxs)("div",{className:"FlexCenter",children:[Object(I.jsx)(je.a,{}),Object(I.jsx)("h4",{className:"Title",children:"Back To Menus"})]})})}),Object(I.jsx)("div",{className:"Sections",children:Object.keys(be.d[n]).map((function(e){return!!Object.keys(be.d[n][e]).length&&!e.startsWith("__")&&Object(I.jsx)(me,{cat:n,sub:e},e)}))})]})]})]}),Object(I.jsx)("div",{className:"Buttons",children:Object(I.jsx)(fe.a,{className:"Button",onClick:function(){return d.a.pop()}})})]})}function me(e){var t=e.cat,n=e.sub;return Object(I.jsxs)("div",{className:"Section",children:[Object(I.jsx)("h3",{className:"Title",children:Object(D.d)(n)}),Object(I.jsx)("div",{className:"Fields",children:Object.entries(be.d[t][n]).map((function(e){return Object(I.jsx)(Oe,{path:[t,n,e[0]],setting:e[1]},e[0])}))})]})}function Oe(e){var t=e.path,n=e.setting,r=l.a.useState(be.c.getSettingValue(t)),a=Object(F.a)(r,2),c=a[0],i=a[1],s=W.a.get(be.d,[].concat(Object(B.a)(t),["value"]),c);function o(e){be.e.dispatch({type:D.a.UPDATE_SETTING,value:e,path:t}),i(e)}var u=l.a.useMemo((function(){switch(n.type){default:return null;case be.a.STRING:var e;return Object(I.jsx)("input",Object(ce.a)({className:"InputField StringField",value:c,onInput:function(e){return o(e.target.value)}},null!==(e=n.props)&&void 0!==e?e:{}));case be.a.COLOUR:var t;return Object(I.jsxs)("div",Object(ce.a)(Object(ce.a)({className:"ColorFieldContainer Flex"},null!==(t=n.props)&&void 0!==t?t:{}),{},{children:[Object(I.jsx)("input",{type:"color",className:"ColorPicker",value:c,onChange:function(e){return o(e.target.value)}}),Object(I.jsx)("input",{className:"InputField StringField ColorField",value:c,onChange:function(e){return o(e.target.value)}})]}));case be.a.BUTTON:var r=n.text,a=n.color,i=n.action,s=n.props,u=void 0===s?{}:s;return Object(I.jsx)("div",Object(ce.a)(Object(ce.a)({className:"Button",onClick:i,style:{color:a}},u),{},{children:r}));case be.a.SWITCH:var d=n.label,b=n.note,j=n.props,f=void 0===j?{}:j;return Object(I.jsx)(ve,Object(ce.a)({title:d,defaultValue:c,callback:o,note:b},f));case be.a.SLIDER:var h=n.min,v=n.max,p=n.step,m=n.renderValue,O=void 0===m?function(e){return e.toFixed(1)}:m,g=n.props,x=void 0===g?{}:g;return Object(I.jsxs)("div",Object(ce.a)(Object(ce.a)({className:"SliderFieldContainer Flex"},x),{},{children:[Object(I.jsx)("h4",{className:"ValueRenderer",children:O(c)}),Object(I.jsx)("input",{type:"range",defaultValue:parseFloat(c),min:h,max:v,step:p,ref:function(e){return e&&(e.style="--value: ".concat(c/v*100,"%"),e.value=c)},onInput:function(e){return o(parseFloat(e.target.value))}})]}));case be.a.CUSTOM:var y=n.component,C=void 0===y?null:y;return l.a.createElement(C)}}),[c]);return Object(I.jsxs)("div",{className:"SettingField",children:[!~[be.a.BUTTON].indexOf(n.type)&&Object(I.jsx)("h4",{className:"Title",children:Object(D.d)(t[t.length-1])}),n.note&&!~[be.a.SWITCH].indexOf(n.type)&&Object(I.jsx)("div",{className:"Note",children:n.note}),Object(I.jsxs)("div",{className:"Field FlexCenter",children:[u,Object(I.jsxs)("div",{className:"ResetButton",style:{display:c!==s?null:"none"},onClick:function(){return o(s)},children:[Object(I.jsx)(he.a,{className:"Icon"}),Object(I.jsx)(w.a,{children:"Reset to default"})]})]})]})}var ge=n(41),xe=n(57),ye=n(46),Ce=n(28),ke=n(13),Ee=n(155);n(131);function Se(){var e=l.a.useState(!1),t=Object(F.a)(e,2),n=t[0],r=t[1];function a(e){return Object(B.a)(e.dataTransfer.items).some((function(e){return"file"===e.kind}))}function c(e){var t,n=Object(ke.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;L.b.dispatch({type:D.a.RTA_ATTACH_FILE,file:r})}}catch(a){n.e(a)}finally{n.f()}}var i=0;return Object(Y.a)("dragenter",(function(e){return++i&&a(e)&&r(!0)})),Object(Y.a)("dragleave",(function(){return!--i&&r(!1)})),Object(Y.a)("dragover",(function(e){return a(e)&&e.preventDefault()})),Object(Y.a)("drop",(function(e){r(!1),a(e)&&(c(Object(B.a)(e.dataTransfer.items).map((function(e){return e.getAsFile()}))),e.preventDefault())})),Object(Y.a)("paste",(function(e){var t=Object(F.a)(e.clipboardData.items,1)[0],n=t?t.getAsFile():null;n&&(c([n]),e.preventDefault())})),Object(I.jsxs)("div",{className:Object(D.i)("FileDragHandler","FlexCenter",[n,"Visible"]),children:[Object(I.jsx)(Ee.a,{className:"FileIcon"}),Object(I.jsx)("h2",{className:"Head",children:"Drop your files to upload."})]})}var Te=n(26),Ne=n(56),we=n(69),Ie=n(76),Ae=n(50),Ue=n(44),_e=n(43),De={Stores:{Store:Te.a,CircleStore:K.a,GroupStore:Q.a,UserStore:y.b,EmotePackStore:Ie.a,EmoteStore:Ae.a,MessageStore:ge.a,MessageCountStore:Z.a,MessageReadStore:xe.a,SettingsStore:be.c,VoiceMemberStore:te.a,TypingStore:Ue.a,CssStore:X.a},Types:{Circle:z.b,Emote:Ne.a,Group:ye.b,Message:we.a,User:_e.b}};function Pe(){var e=y.b.useState(y.b.getLocalUser);return null===e&&(_.a.showToast("You must be signed in to access the app","Failure"),window.location.assign(window.location.origin)),e?Object(I.jsx)("div",{className:"AppPage",children:Object(I.jsx)(Re,{localUser:e})}):null}var Le,Me=W.a.debounce((function(){var e=y.b.getLocalUser();e.status===D.c.ONLINE&&R.a.update(e._ref,{status:D.c.AWAY})}),6e5);function Re(e){var t,n=e.localUser,r=null!==(t=R.a.useSnapshot(R.a.collection("userdata",n.id,"circles"),{processor:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(n=K.a.getCircles()[t.id])||void 0===n){e.next=4;break}e.t0=n,e.next=7;break;case 4:return e.next=6,K.a.fetchCircle(t.id);case 6:e.t0=e.sent;case 7:return r=e.t0,e.abrupt("return",W.a.assign(r,t));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}))&&void 0!==t?t:{},a=r.items;return a&&Le!==a&&(L.b.dispatch({type:D.a.CIRCLES_UPDATE,circles:a}),Le=a),Object(Y.e)((function(){q.b.initialize(),Object.defineProperty(window,"API",{value:De})})),Object(Y.a)("focus",(function(){var e=Q.a.getSelectedGroup();null===e||void 0===e||e.markAsRead()}),{target:window}),Object(Y.b)((function(){var e=y.b.getLocalUser();if(document.hasFocus()&&e&&(Me(),~[D.c.AWAY,D.c.OFFLINE,void 0].indexOf(e.status)&&R.a.update(e._ref,{status:D.c.ONLINE}),e.status!==D.c.AWAY)){var t,n=Q.a.getSelectedGroup();if(!n)return;var r,a=Object.keys(null!==(t=ge.a.getMessages(n.circleId,n.id))&&void 0!==t?t:{}).slice(-1)[0];if(a&&W.a.get(xe.a.getAllCachedReads(),[n.circleId,n.id]))if((null===(r=W.a.get(xe.a.getReads(n.circleId,n.id),[e.id]))||void 0===r?void 0:r.messageId)!==a){var c=R.a.doc.apply(R.a,Object(B.a)(n.isDm?["directmessages",ye.a.getId(n.id)]:["circles",n.circleId,"groups",n.id]).concat(["lastread",e.id]));R.a.set(c,{messageId:a,timestamp:Object(Ce.m)()})}}}),2e3),void 0===a?Object(I.jsx)(Fe,{}):Object(I.jsxs)("div",{className:"Core",children:[Object(I.jsx)(X.a.Renderer,{}),Object(I.jsx)(be.b,{}),Object(I.jsx)(Se,{}),Object(I.jsx)(Fe,{hidden:!0}),Object(I.jsxs)("div",{className:"Panel PanelMain Flex",children:[Object(I.jsxs)("div",{className:"Panel PanelCircles",children:[Object(I.jsx)("div",{className:"Circles",children:a.sort((function(e,t){return e.position-t.position})).map((function(e){return e instanceof z.b&&Object(I.jsx)(e.BubbleComponent,{},e.id)}))}),Object(I.jsx)(Be,{})]}),Object(I.jsx)("div",{className:"Panel PanelCore",children:Object(I.jsx)(le,{})})]}),Object(I.jsxs)("div",{className:"Panel PanelFooter FlexCenter",children:[Object(I.jsxs)("div",{className:"Circle",onClick:function(){return Ye("app/dms/")},children:[Object(I.jsx)(H.a,{className:"Icon"}),Object(I.jsx)(w.a,{children:"DMs"})]}),Object(I.jsxs)(P.a.Wrapper,{menu:Object(I.jsx)(n.ContextMenu,{}),wrapperClassName:"LocalUserHead FlexCenter",children:[Object(I.jsx)("div",{className:"Circle",children:Object(I.jsx)(n.AvatarComponent,{className:"Icon"})}),Object(I.jsxs)("div",{className:"Details",children:[Object(I.jsx)("h4",{className:"Username",children:n.displayName}),Object(I.jsx)(n.StatusText,{})]})]}),Object(I.jsx)("div",{className:"Divider"}),Object(I.jsx)(J.a,{})]})]})}function Fe(e){var t=e.hidden,n=void 0!==t&&t;return Object(I.jsx)("div",{className:Object(D.i)("LoadingOverlay","FlexCenter",[n,"Hidden"]),children:Object(I.jsx)($.a,{style:{fontSize:"2em"}})})}function Be(){var e=y.b.useState((function(){return y.b.getLocalUser()}));L.b.useForceUpdater(D.a.UPDATE_MESSAGE_COUNT,(function(t){return~t.circleId.split("_").indexOf(null===e||void 0===e?void 0:e.id)})),L.b.useForceUpdater(D.a.UPDATE_READ_COUNT,(function(t){return~t.circleId.split("_").indexOf(null===e||void 0===e?void 0:e.id)})),L.b.useForceUpdater(D.a.BATCH_UPDATE_DMS);var t=Q.a.getGroups("dms"),n=Object.values(null!==t&&void 0!==t?t:{}).map((function(e){return[e.id,Z.a.getUnreadMessageCount(e.groupId)]}),{});return Object(I.jsxs)("div",{className:"DmBubbles",children:[Object(I.jsx)(z.a,{circle:{id:"__settings",name:"Settings"},icon:Object(I.jsx)(V.a,{}),onClick:function(){return d.a.push(Object(I.jsx)(pe,{}))}}),n.map((function(e){var t=Object(F.a)(e,2),n=t[0],r=t[1];return r>0&&Object(I.jsx)(Ge,{userId:n,unreadCount:r},n)}))]})}function Ge(e){var t=e.userId,n=e.unreadCount,r=y.b.getUser(t),a=Q.a.getSelectedGroup();return(null===a||void 0===a?void 0:a.id)===t&&document.hasFocus()&&Z.a.markRead(a.groupId),L.b.useForceUpdater(D.a.USER_UPDATE,(function(e){return e.user.id===t})),l.a.useEffect((function(){n<=0||(null===a||void 0===a?void 0:a.id)===t&&document.hasFocus()||Object(D.l)(de,.5)}),[n]),r?Object(I.jsxs)("div",{className:"Circle DmBubble",onClick:function(){return Ye("#app/dms/".concat(t))},children:[l.a.createElement(r.AvatarComponent,{size:40}),Object(I.jsx)("div",{className:"UnreadBlips Flex",children:Object(I.jsx)("div",{className:"Blip Mention",children:n>999?"".concat(Math.round(n/1e3),"k"):n})}),Object(I.jsx)(w.a,{direction:"right",children:r.displayName})]},t):null}var We=n(54);n(132);function He(){var e,t=l.a.useState([]),n=Object(F.a)(t,2),r=n[0],a=n[1];return l.a.useEffect((function(){var e=function(e){var t=e.notification;a([].concat(Object(B.a)(r),[t]))};return L.b.subscribe(D.a.DISPLAY_BANNER_NOTIFICATION,e),function(){return L.b.unsubscribe(D.a.DISPLAY_BANNER_NOTIFICATION,e)}}),[r]),Object(I.jsx)("div",{className:"BannerNotifications",children:!!r.length&&Object(I.jsxs)("div",{className:"Notif FlexCenter",children:[Object(I.jsx)("div",{className:"Contents",children:l.a.createElement(null!==(e=r[0])&&void 0!==e?e:"")}),Object(I.jsx)(fe.a,{className:"Button CloseButton",onClick:function(){return a(r.slice(1))}})]})})}function Ve(e){return e.startsWith("#")?e:"#".concat(e)}function Ye(e){e=Ve(e),window.history.pushState({last:window.location.hash,lastTime:Date.now()},null,e),L.b.dispatch({type:D.a.PAGE_UPDATE})}window.addEventListener("popstate",(function(){L.b.dispatch({type:D.a.PAGE_UPDATE})}));var ze=[];function Ke(){var e;L.b.useForceUpdater(D.a.PAGE_UPDATE);var t=(null!==(e=window.location.hash.split(/#\/?/)[1])&&void 0!==e?e:"").split("?")[0].split("/"),n=Object(o.a)(t),r=n[0],a=n.slice(1);return r,ze=a,"app"===r?Object(I.jsx)(Pe,{}):Object(I.jsx)(U,{})}function Xe(){return L.b.useForceUpdater(D.a.PAGE_UPDATE),l.a.useEffect((function(){Object(M.c)(R.a.auth,function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,!(null===t||void 0===t?void 0:t.uid)){e.next=9;break}return e.next=4,y.b.fetchUser(t.uid);case 4:return n=e.sent,r=We.a.createDisconnectListener("userstatus/".concat(n.id)),e.next=8,r.setWithPriority({o:!1},100);case 8:We.a.set("userstatus/".concat(n.id),{o:!0});case 9:L.b.dispatch({type:D.a.LOCAL_USER_UPDATE,user:n});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),~navigator.userAgent.indexOf("Firefox")&&L.b.dispatch({type:D.a.DISPLAY_BANNER_NOTIFICATION,notification:function(){return Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("b",{children:"WARNING"})," - You're using an unsupported browser. You ",Object(I.jsx)("b",{children:"will"})," run into bugs and issues; please do not report these without testing on a modern web browser beforehand."]})}})}),[]),Object(I.jsxs)("div",{className:"App",children:[Object(I.jsx)(He,{}),Object(I.jsx)("div",{className:"Main",children:Object(I.jsx)(Ke,{})}),"#app"!==window.location.hash.split("/")[0].split("?")[0]&&Object(I.jsx)(A,{}),Object(I.jsx)(d.a,{}),Object(I.jsx)(_.a,{}),Object(I.jsx)(P.a.Handler,{})]})}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return l}));n(19);var r=n(15),a=n(3),c=n.n(a);n(30);function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];c.a.useEffect((function(){var r=setInterval(e,t);return n&&e(),function(){return clearInterval(r)}}),r)}function s(){var e=c.a.useRef(!1);return c.a.useEffect((function(){return e.current=!0,function(){e.current=!1}}),[]),e}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.target,a=void 0===r?document:r,i=n.dependencies,s=void 0===i?[]:i,o=n.init,u=void 0!==o&&o;c.a.useEffect((function(){return a.addEventListener(e,t),u&&t(),function(){return a.removeEventListener(e,t)}}),s)}function u(e){c.a.useEffect((function(){e()}),[])}function l(e,t){var n=c.a.useMemo((function(){return window.matchMedia("(".concat(e,": ").concat(t,"px)"))}),[e,t]),a=c.a.useState(n.matches),i=Object(r.a)(a,2),s=i[0],o=i[1];return c.a.useEffect((function(){var e=function(e){return o(e.matches)};return n.addEventListener("change",e),function(){return n.removeEventListener("change",e)}}),[e,t]),s}},,,,,function(e,t,n){"use strict";var r,a=n(8),c=n(0),i=n.n(c),s=n(5),o=n(2),u=n(4),l=n(10),d=n(11),b=n(12),j=n.n(b),f=n(9),h=n(17),v=n(14),p=n(26),m=n(20),O=n(16),g={},x={},y={},C=!1,k=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"_initializeReadListener",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.b&&(t=O.b.getLocalUser())){e.next=5;break}return e.next=3,new Promise((function(e){return setTimeout(e,250)}));case 3:e.next=0;break;case 5:h.a.createSnapshotListener(h.a.doc("usersettings",t.id,"v2","readCounts"),(function(e){for(var t in e=h.a.serializeObject(e))for(var n in e[t])v.b.dispatch({type:f.a.UPDATE_READ_COUNT,circleId:t,groupId:n,value:e[t][n],fromDb:!0});C=!0}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_initializeListenerFor",value:function(e){var t=this;y[e]||(y[e]=h.a.createSnapshotListener(h.a.doc("messageCounts",e),(function(n){n=h.a.serializeObject(n);var r=m.a.getSelectedGroup();for(var a in n)"t"!==a&&(v.b.dispatch({type:f.a.UPDATE_MESSAGE_COUNT,circleId:e,groupId:a,value:n[a]||0}),(null===r||void 0===r?void 0:r.id)===a&&document.hasFocus()&&t.markRead(e,a));v.b.dispatch({type:f.a.UPDATE_MESSAGE_COUNT,circleId:e,groupId:"__total",value:n.t||0}),(null===r||void 0===r?void 0:r.groupId)===e&&document.hasFocus()&&t.markRead(e)})))}},{key:"getMessageCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return y[e]||this._initializeListenerFor(e),j.a.get(g,[e,null!==t&&void 0!==t?t:"__total"])||0}},{key:"getUnreadMessageCount",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;y[e]||this._initializeListenerFor(e);var n=0,r=0;if(null!=t||~e.split("_").indexOf(O.b.getLocalUser().id))n=this.getMessageCount(e,t),r=j.a.get(x,[e,null!==t&&void 0!==t?t:"__total"]);else for(var a in null!==(c=g[e])&&void 0!==c?c:{}){var c;"__total"!==a&&(n+=this.getMessageCount(e,a),r+=j.a.get(x,[e,a],0))}return(!r||n<r)&&n!==r?(j.a.set(x,[e,t],n),n):n-r<=0?0:n-r}},{key:"markRead",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;v.b.dispatch({type:f.a.UPDATE_READ_COUNT,circleId:e,groupId:null!==t&&void 0!==t?t:"__total",value:null!==n&&void 0!==n?n:this.getMessageCount(e,t)})}},{key:"pushValue",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=j.a.get(g,[e,t]),a=j.a.get(g,[e,"__total"]);if(!~[r,a].indexOf(void 0)){j.a.set(g,[e,t],r+n),j.a.set(g,[e,"__total"],r+n);var c=m.a.getSelectedGroup();c&&c.circleId===e&&c.id===t&&this.markRead(e,t)}}}]),n}(p.a),E=j.a.debounce((function(){C&&h.a.set(h.a.doc("usersettings",O.b.getLocalUser().id,"v2","readCounts"),x)}),3e3),S=new k(v.b,(r={},Object(a.a)(r,f.a.UPDATE_MESSAGE_COUNT,(function(e){var t=e.circleId,n=e.groupId,r=e.value;j.a.set(g,[t,n],r)})),Object(a.a)(r,f.a.UPDATE_READ_COUNT,(function(e){var t=e.circleId,n=e.groupId,r=e.value,a=e.fromDb;j.a.set(x,[t,n],r),!a&&E()})),r));S._initializeReadListener(),t.a=S},,function(e,t,n){"use strict";var r,a=n(8),c=n(0),i=n.n(c),s=n(5),o=n(2),u=n(4),l=n(10),d=n(11),b=n(12),j=n.n(b),f=n(9),h=n(17),v=n(14),p=n(26),m=n(47),O=n(41),g=n(44),x={},y=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"getCircle",value:function(e){var t;return null!==(t=x[e])&&void 0!==t?t:(this.fetchCircle(e),new m.b({id:e,loading:!0,name:"..."}))}},{key:"getCircles",value:function(){return x}},{key:"fetchCircle",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var n,r=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]&&r[1],e.abrupt("return",new Promise((function(e){var r=h.a.createSnapshotListener(h.a.doc("circles",t),(function(a){var c,i=a?j.a.extend(null!==(c=x[t])&&void 0!==c?c:new m.b,a):new m.b({id:t,name:"Invalid Circle"});g.a.tryCreateListenerFor(t),v.b.dispatch({type:f.a.CIRCLE_UPDATE,circle:i}),n&&r(),e(i)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"destroyCircle",value:function(e){var t,n=x[e];if(n){n._unbindListener();var r=null!==(t=O.a.getCleanupCache()[e])&&void 0!==t?t:{};for(var a in r)O.a.cleanup(e,a);delete x[e]}}}]),n}(p.a),C=new y(v.b,(r={},Object(a.a)(r,f.a.CIRCLE_UPDATE,(function(e){var t=e.circle;x[t.id]=t})),Object(a.a)(r,f.a.CIRCLE_UPDATE_GROUPS,(function(e){var t=e.circle,n=e.groups;x[t.id]._groups=n})),r));t.a=C},,function(e,t,n){"use strict";(function(e){var r,a=n(8),c=n(0),i=n.n(c),s=n(13),o=n(5),u=n(2),l=n(4),d=n(10),b=n(11),j=n(28),f=n(12),h=n.n(f),v=n(9),p=n(17),m=n(14),O=n(26),g=n(46),x=n(69),y=n(20),C=n(37),k=n(16),E={},S={},T={},N=function(t){Object(d.a)(r,t);var n=Object(b.a)(r);function r(){return Object(u.a)(this,r),n.apply(this,arguments)}return Object(l.a)(r,[{key:"getMessage",value:function(e,t,n){return h.a.get(E,[e,t,n])}},{key:"getMessages",value:function(e,t){var n;return null!==(n=h.a.get(E,[e,t]))&&void 0!==n?n:(this.fetchMessages(e,t),null)}},{key:"getMessageGroups",value:function(e,t){var n=this.getMessages(e,t);if(!n)return null;for(var r,a,c=[],i=0,s=Object.values(n);i<s.length;i++){var o,u,l=s[i],d=(null===(o=r)||void 0===o?void 0:o.senderId)!==l.senderId,b=l.creationDate-(null===(u=r)||void 0===u?void 0:u.creationDate)>600;(!r||d||b)&&(a&&r&&c.push({key:"mg-"+r.id,userId:r.senderId,messages:a}),a=[]),a.push(l),r=l}return a&&c.push({key:"mg-"+a[0].id,userId:a[0].senderId,messages:a}),c.reverse()}},{key:"getAllCachedMessages",value:function(){return E}},{key:"getCleanupCache",value:function(){return S}},{key:"tickCache",value:function(e,t){var n,r=h.a.get(S,[e,t],{});null===(n=r.tick)||void 0===n||n.call(r)}},{key:"cleanup",value:function(e,t){var n,r=h.a.get(S,[e,t],{});null===(n=r.instantly)||void 0===n||n.call(r)}},{key:"fetchMessages",value:function(){var t=Object(o.a)(i.a.mark((function t(n,r){var a,c=this;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h.a.get(T,[n,r])){t.next=2;break}return t.abrupt("return");case 2:return h.a.set(T,[n,r],!0),a="dms"===n?g.a.getId(r):null,t.abrupt("return",new Promise((function(t){var i="dms"===n?p.a.collection("directmessages",a,"messages"):p.a.collection("circles",n,"groups",r,"messages"),o=p.a.createSnapshotListener(Object(j.l)(i,Object(j.k)("creationDate"),Object(j.i)(50)),(function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=a.changes,o=void 0===i?[]:i;h.a.set(T,[n,r],null);var u,l=Object(s.a)(o);try{for(l.s();!(u=l.n()).done;){var d=u.value;switch(d.type){case"added":m.b.dispatch({type:v.a.MESSAGE_CREATE,circleId:n,groupId:r,message:new x.a(d.data)}),o.length<=2&&C.a.pushValue(n,r);break;case"modified":var b;m.b.dispatch({type:v.a.MESSAGE_UPDATE,circleId:n,groupId:r,message:h.a.extend(null!==(b=c.getMessage(n,r))&&void 0!==b?b:new x.a(d.data),d.data)});break;case"removed":m.b.dispatch({type:v.a.MESSAGE_DELETE,circleId:n,groupId:r,messageId:d.doc.id})}}}catch(j){l.e(j)}finally{l.f()}e((function(){m.b.dispatch({type:v.a.CHAT_UPDATE,circleId:n,groupId:r})})),t(h.a.get(E,[n,r]))})),u="dms"===n?p.a.collection("directmessages",a,"lastread"):p.a.collection("circles",n,"groups",r,"lastread"),l=p.a.createSnapshotListener(Object(j.l)(u,Object(j.k)("timestamp"),Object(j.i)(10)),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.items,a=void 0===t?[]:t;m.b.dispatch({type:v.a.UPDATE_READS,circleId:n,groupId:r,reads:a})})),d=function(){o(),l(),delete E[n][r],delete S[n][r]};h.a.set(S,[n,r],{instantly:d,tick:h.a.debounce(d,6e5)})})));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),r}(O.a),w=new N(m.b,(r={},Object(a.a)(r,v.a.MESSAGE_CREATE,(function(e){var t=e.circleId,n=e.groupId,r=e.message;h.a.set(E,[t,n,r.id],r)})),Object(a.a)(r,v.a.MESSAGE_UPDATE,(function(e){var t=e.circleId,n=e.groupId,r=e.message;h.a.set(E,[t,n,r.id],r)})),Object(a.a)(r,v.a.MESSAGE_DELETE,(function(e){var t,n,r=e.circleId,a=e.groupId,c=e.messageId;null===(t=E[r])||void 0===t||(null===(n=t[a])||void 0===n||delete n[c])})),Object(a.a)(r,v.a.SEND_MESSAGE,(function(e){var t=e.circleId,n=e.groupId,r=e.group,a=void 0===r?null:r,c=e.content;if(a||(a=y.a.getGroup(t,n)),!a)return console.error("Can't send message to uncached/invalid group!",{circleId:t,groupId:n});Object(j.b)(Object(j.c)(a._ref,"messages"),{senderId:k.b.getLocalUser().id,creationDate:Object(j.m)(),content:c})})),Object(a.a)(r,v.a.DELETE_MESSAGE,(function(e){var t=e.circleId,n=e.groupId,r=e.group,a=void 0===r?null:r,c=e.messageId;a||(a=y.a.getGroup(t,n)),a&&Object(j.d)(w.getMessage(a.circleId,a.id,c)._ref)})),Object(a.a)(r,v.a.EDIT_MESSAGE,(function(e){var t=e.circleId,n=e.groupId,r=e.group,a=void 0===r?null:r,c=e.messageId,i=e.content;a||(a=y.a.getGroup(t,n)),a&&Object(j.o)(w.getMessage(a.circleId,a.id,c)._ref,{content:i,editedAt:Object(j.m)()})})),r));t.a=w}).call(this,n(52).setImmediate)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(18),a=(n(3),n(102),n(1));function c(e){return Object(a.jsxs)("div",Object(r.a)(Object(r.a)({className:"InlineLoadingContainer"},e),{},{children:[Object(a.jsx)("div",{className:"Dot A"}),Object(a.jsx)("div",{className:"Dot B"}),Object(a.jsx)("div",{className:"Dot C"})]}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return M})),n.d(t,"a",(function(){return B}));var r=n(0),a=n.n(r),c=n(15),i=n(5),s=n(18),o=n(2),u=n(4),l=n(3),d=n.n(l),b=n(12),j=n.n(b),f=(n(112),n(9)),h=n(16),v=n(29),p=n(139),m=n(78),O=n(165),g=n(166),x=n(161),y=n(27),C=n(22),k=n(137),E=n(164),S=n(138),T=n(17),N=n(14),w=n(48),I=n(70),A=n(42),U=n(23),_=(n(120),n(1));function D(e){var t,n=e.userId,r=h.b.useState((function(){return h.b.getUser(n)})),s=h.b.getLocalUser(),o=d.a.useRef(),u=d.a.useRef(),l=d.a.useState(!1),b=Object(c.a)(l,2),v=b[0],p=b[1],m=d.a.useState(!1),O=Object(c.a)(m,2),g=O[0],x=O[1];function y(){return D.apply(this,arguments)}function D(){return D=Object(i.a)(a.a.mark((function e(){var t,n,r,i,o=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]&&o[0],e.next=3,Object(f.k)({type:"image/*"});case 3:if(n=e.sent,r=Object(c.a)(n,1),i=r[0]){e.next=8;break}return e.abrupt("return");case 8:if(!(i.size>Object(f.j)(10))){e.next=10;break}return e.abrupt("return",U.a.showToast("You cannot upload a background above 10MiB","Failure"));case 10:T.a.uploadStorage(i,t?"profilebgNsfw":"profilebg",s.id).then((function(e){return s[t?"profileBackgroundNsfw":"profileBackground"]=e.url,U.a.showToast("Background updated - changes will show after confirming changes","Warning",10)})).catch((function(e){return console.error(e),U.a.showToast("There was an error uploading your background image","Failure")}));case 11:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}return N.b.useForceUpdater(f.a.USER_UPDATE,(function(e){return e.user.id===n})),Object(_.jsxs)("div",{className:"UserProfileModal FullScreenModal Flex",children:[Object(_.jsxs)("div",{className:"Background FlexCenter",children:[r.profileBackground&&Object(_.jsx)(A.a,{}),Object(_.jsx)("img",{ref:o,className:"Image",src:r.profileBackground,onLoad:function(e){return e.target.style.opacity=1}}),r.profileBackgroundNsfw&&M.isNsfwVerified&&Object(_.jsx)("img",{ref:u,className:"Image",src:r.profileBackgroundNsfw})]}),Object(_.jsxs)("div",{className:"LeftSection Flex",children:[Object(_.jsx)(r.AvatarComponent,{size:250}),Object(_.jsx)("h3",{className:"Username",children:r.displayName}),v?Object(_.jsx)(I.a,{defaultValue:r.feed,id:"UserFeed",children:"Specify what you're up to currently with your user feed."}):r.feed&&Object(_.jsx)("div",{className:"Feed",children:w.a.parse(r.feed)}),Object(_.jsx)("div",{className:"AboutFields",children:null===(t=r.about)||void 0===t?void 0:t.map((function(e,t){return Object(_.jsxs)("div",{className:"AboutField",children:[Object(_.jsx)("h3",{className:"Title",children:e.title}),Object(_.jsx)("div",{className:"Body",children:e.field})]},t)}))}),v&&Object(_.jsxs)(d.a.Fragment,{children:[Object(_.jsx)("h4",{className:"Button",onClick:function(){return y()},children:"Pick Background Image"}),Object(_.jsx)("h4",{className:"Button",onClick:function(){return y(!0)},children:"Pick NSFW Background"})]}),r.profileBackgroundNsfw&&M.isNsfwVerified&&Object(_.jsxs)("h4",{className:"Button NsfwToggle",onClick:function(){return x(!g),u.current.style.opacity=g?0:1},children:[g?"Hide":"Show"," NSFW Background"]})]}),Object(_.jsx)("div",{className:"RightSection Flex",children:Object(_.jsxs)("div",{children:[Object(_.jsx)("h1",{className:"Header",children:"Bio"}),Object(_.jsx)("div",{className:Object(f.i)("Bio MessageGroup",[v,"EditMode"]),children:v?Object(_.jsx)(I.a,{defaultValue:r.bio,id:"UserBio",children:"Describe yourself with a personal bio."}):r.bio?w.a.parse(r.bio):Object(_.jsx)("div",{className:"Placeholder",children:"This user has no bio."})})]})}),Object(_.jsxs)("div",{className:"Buttons",children:[r===s&&(v?Object(_.jsx)(k.a,{className:"Button",onClick:function(){return p(!1),Object.assign(s,{feed:document.getElementById("UserFeed").value,bio:document.getElementById("UserBio").value}),T.a.update(s._ref,j.a.pick(s,["displayName","feed","bio","avatarUrl","backgroundImage","backgroundImageNsfw"])).then((function(){return U.a.showToast("Successfully updated profile")}))}}):Object(_.jsx)(E.a,{className:"Button",onClick:function(){return p(!0)}})),Object(_.jsx)(S.a,{className:"Button",onClick:function(){return C.a.pop()}})]})]})}var P=n(30),L=n(25),M=function(){function e(t){var n=this;Object(o.a)(this,e),this.id="",this.displayName="",this.avatarUrl="",this.AvatarComponent=function(e){return Object(_.jsx)(R,Object(s.a)({user:n},e))},this.StatusText=function(e){return Object(_.jsx)(F,Object(s.a)({user:n},e))},this.Mention=function(){return Object(_.jsx)(B,{user:n})},this.ContextMenu=function(){return Object(_.jsx)(G,{user:n})},j.a.extend(this,t)}return Object(u.a)(e,[{key:"getColor",value:function(){var e;return this.id===(null===(e=h.b.getLocalUser())||void 0===e?void 0:e.id)?"var(--primary-color)":"var(--secondary-color)"}}],[{key:"selectAvatar",value:function(){var e=Object(i.a)(a.a.mark((function e(){var t,n,r,i=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.k)({type:"image/*"});case 2:if(t=e.sent,n=Object(c.a)(t,1),r=n[0]){e.next=7;break}return e.abrupt("return");case 7:if(!(r.size>Object(f.j)(8))){e.next=9;break}return e.abrupt("return",U.a.showToast("You cannot upload an avatar above 8MiB","Failure"));case 9:T.a.uploadStorage(r,"avatar",h.b.getLocalUser().id).then((function(e){return i.avatarUrl=e.url,U.a.showToast("Avatar updated")})).catch((function(e){return console.error(e),U.a.showToast("There was an error uploading your avatar","Failure")}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"age",value:function(e){var t;return"string"===typeof e&&(e=new Date(e)),"function"===typeof(null===(t=e)||void 0===t?void 0:t.toDate)&&(e=e.toDate()),(Date.now()-e)/3154e7}},{key:"isNsfwVerified",get:function(){if(!h.b.getLocalUser())return!1;var e=L.c.getSettingValue("account","privacy","ageVerification"),t=L.c.getSettingValue("account","privacy","showNsfwContent");return!(!e||!t)&&Math.floor(this.age(e))>=18}}]),e}();function R(e){var t=e.user,n=e.size,r=void 0===n?40:n,a=e.className,i=void 0===a?"":a,o=e.style,u=void 0===o?{}:o,l=h.b.useState((function(){return t.avatarUrl})),b=h.b.useState((function(){return t.displayName})),j=d.a.useState(!1),v=Object(c.a)(j,2),m=v[0],O=v[1];return Object(_.jsx)("div",{className:Object(f.i)("AvatarContainer StyleSquare FlexCenter",i),style:Object(s.a)({width:r,height:r},u),children:m?Object(_.jsx)(p.a,{className:"DefaultAvatar",style:{width:r/1.5,height:r/1.5}}):Object(_.jsx)("img",{className:"Avatar",src:l,alt:b,width:r,height:r,onError:function(){return O(!0)}})})}function F(e){var t=e.user,n=e.tooltipDirection,r=void 0===n?"right":n,a=h.b.useState((function(){return t.status})),c=t.lastOnline?new Date(t.lastOnline):null;switch(a){default:case f.c.OFFLINE:return Object(_.jsxs)("div",{className:"Flex StatusContainer",children:[Object(_.jsx)("div",{className:"Status Offline"}),Object(_.jsx)("div",{children:"Offline"}),c&&"none"!==r&&Object(_.jsxs)(v.a,{direction:r,children:["Last online ",Object(f.e)(c)," at ",c.toLocaleTimeString("en-US")]})]});case f.c.ONLINE:return Object(_.jsxs)("div",{className:"Flex StatusContainer",children:[Object(_.jsx)("div",{className:"Status Online"}),Object(_.jsx)("div",{children:"Online"})]});case f.c.AWAY:return Object(_.jsxs)("div",{className:"Flex StatusContainer",children:[Object(_.jsx)("div",{className:"Status Away"}),Object(_.jsx)("div",{children:"Away"})]});case f.c.BUSY:return Object(_.jsxs)("div",{className:"Flex StatusContainer",children:[Object(_.jsx)("div",{className:"Status Busy"}),Object(_.jsx)("div",{children:"Busy"})]});case f.c.BOT:return Object(_.jsxs)("div",{className:"Flex StatusContainer",children:[Object(_.jsx)("div",{className:"Status Bot"}),Object(_.jsx)("div",{children:"Bot"})]})}}function B(e){var t=e.user,n=e.convertToYou,r=void 0!==n&&n;return N.b.useForceUpdater(f.a.USER_UPDATE,(function(e){return e.user.id===t.id})),t=h.b.getUser(t.id),Object(_.jsxs)(y.a.Wrapper,{menu:Object(_.jsx)(t.ContextMenu,{}),wrapperClassName:"UserMention",children:[Object(_.jsx)(R,{user:t,size:19}),Object(_.jsx)("div",{className:"Username",children:r&&t.id===h.b.getLocalUser().id?"You":t.displayName})]})}function G(e){var t=e.user;return Object(_.jsxs)(y.a,{children:[Object(_.jsx)(y.a.Item,{icon:Object(_.jsx)(p.a,{}),onClick:function(){return C.a.push(Object(_.jsx)(D,{userId:t.id}))},autoClose:!0,children:"Profile"}),Object(_.jsx)(y.a.Item,{icon:Object(_.jsx)(m.a,{}),onClick:function(){return Object(P.c)("app/dms/".concat(t.id))},autoClose:!0,children:"Message"}),t.avatarUrl&&Object(_.jsxs)(y.a.SubMenuItem,{label:"Avatar",icon:Object(_.jsx)(O.a,{}),children:[Object(_.jsx)(y.a.Item,{icon:Object(_.jsx)(g.a,{}),onClick:function(){return Object(C.e)(t.avatarUrl)},autoClose:!0,children:"View"}),Object(_.jsx)(y.a.Item,{icon:Object(_.jsx)(x.a,{}),onClick:function(){return Object(C.c)(t.avatarUrl)},autoClose:!0,children:"Copy URL"})]})]})}},function(e,t,n){"use strict";var r=n(8),a=n(2),c=n(4),i=n(24),s=n(10),o=n(11),u=n(12),l=n.n(u),d=n(9),b=n(14),j=n(54),f=n(26),h=n(46),v=n(20),p=n(16),m={},O={},g=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).stopTypingSoft=l.a.debounce(e.stopTyping.bind(Object(i.a)(e)),5e3),e}return Object(c.a)(n,[{key:"_getRefPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"dms"===e?"typingIndicators/dms/".concat(h.a.getId(t)):t?"typingIndicators/".concat(e,"/").concat(t):"typingIndicators/".concat(e)}},{key:"getTypingUsersForCircle",value:function(e){if("dms"===e)throw new Error("Not allowed to fetch all DM typing indicators!");return l.a.get(m,[e])}},{key:"getTypingUsersForGroup",value:function(e,t){return l.a.get(m,"dms"===e?[t]:[e,t],{})}},{key:"getAllTypingUsers",value:function(){return m}},{key:"tryCreateListenerFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!O[null!==t&&void 0!==t?t:e]&&(e||t)){var n=this._getRefPath(e,t),r=j.a.createDisconnectListener("".concat(n,"/").concat(p.b.getLocalUser().id));r.remove();var a=j.a.createListener(n,(function(n){var r=n.val();b.b.dispatch({type:d.a.UPDATE_TYPING_INDICATORS,indicators:r,circleId:e,userId:t})}));O[null!==t&&void 0!==t?t:e]=function(){a(),r.cancel(),delete O[null!==t&&void 0!==t?t:e]}}}},{key:"startTyping",value:function(){var e=v.a.getSelectedGroup();if(e){var t="".concat(this._getRefPath(e.circleId,e.id),"/").concat(p.b.getLocalUser().id);l.a.get(this.getTypingUsersForGroup(e.circleId,e.id),[p.b.getLocalUser().id])||j.a.set(t,{t:!0}).catch(console.error.bind(null,"Failed to set typing state!")),this.stopTypingSoft(e.circleId,e.id)}}},{key:"stopTyping",value:function(e,t){if(!e){var n=v.a.getSelectedGroup();if(!n)return;e=n.circleId,t=n.id}var r="".concat(this._getRefPath(e,t),"/").concat(p.b.getLocalUser().id);j.a.set(r,null).catch(console.error.bind(null,"Failed to stop typing!"))}}]),n}(f.a),x=new g(b.b,Object(r.a)({},d.a.UPDATE_TYPING_INDICATORS,(function(e){var t=e.circleId,n=e.userId,r=e.indicators;l.a.set(m,[n||t],r)})));t.a=x},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return N}));var r=n(8),a=n(13),c=n(0),i=n.n(c),s=n(18),o=n(5),u=n(2),l=n(4),d=n(12),b=n.n(d),j=n(9),f=n(14),h=n(20),v=n(16),p="UPDATE_MEMBERS",m="INITIALIZE",O="CONNECT",g="DISCONNECT",x="PC_ANSWER",y="SEND_ICE",C="REQUEST_CONSUMER",k="RECEIVE_CONSUMER",E="UPDATE_CONSUMER_ICE",S=new(function(){function t(){Object(u.a)(this,t),this.currentRoom=null}return Object(l.a)(t,[{key:"initialize",value:function(){var t=Object(o.a)(i.a.mark((function t(){var n,r=this;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.initialized){t.next=2;break}return t.abrupt("return");case 2:this.initialized=!0,"voice.cirlos.net",window.location.hostname,"46236",n=function(){return new WebSocket("wss://".concat("voice.cirlos.net",":").concat("46236"))},this.socket=n(),this.socket.onerror=console.error,console.log("socket",this.socket),this.socket.addEventListener("message",(function(e){var t=e.data,n=JSON.parse(t);if(console.log("voice ws message",n),n.type===p)f.b.dispatch(Object(s.a)(Object(s.a)({},n),{},{type:j.a.UPDATE_VOICE_MEMBERS}))})),this.socket.addEventListener("close",(function(e){console.log("what",e)})),f.b.subscribe(j.a.CIRCLES_UPDATE,function(){var t=Object(o.a)(i.a.mark((function t(n){var a,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=n.circles,c=a.map((function(e){return e.id}));case 2:if(r.socket.readyState===WebSocket.OPEN){t.next=7;break}return t.next=5,new Promise((function(t){return e(t)}));case 5:t.next=2;break;case 7:r.socket.send(JSON.stringify({type:m,userId:v.b.getLocalUser().id,circleIds:c}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}()),T={iceServers:[{urls:["stun:voice.cirlos.net:5349"]},{urls:["turn:voice.cirlos.net:5349"],username:"dog",credential:"shit"}]},N=function(){function e(t,n){Object(u.a)(this,e),this.connections={};var r=h.a.getGroup(t,n);if(!r)return console.error("Unable to find voice group!",{circleId:t,groupId:n}),null;this.group=r,this.handleMessage=this.handleMessage.bind(this)}return Object(l.a)(e,[{key:"emitSocket",value:function(e){console.log("emitting socket event",e),S.socket.send(JSON.stringify(e))}},{key:"connect",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S.currentRoom){e.next=3;break}return e.next=3,S.currentRoom.disconnect();case 3:console.log("should connect"),S.socket.addEventListener("message",this.handleMessage),this.initializePeerConnection().catch(console.error.bind("Failed to initialize peer connection!")),f.b.dispatch({type:j.a.UPDATE_CURRENT_CALL,call:this}),S.currentRoom=this;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createPeerConnection",value:function(){return b.a.extend(new RTCPeerConnection(T),{onicecandidate:this.handleIceCandidate.bind(this),onnegotiationneeded:this.handleNegotiation.bind(this)})}},{key:"handleIceCandidate",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(null===(r=t.candidate)||void 0===r||null===(n=r.candidate)||void 0===n?void 0:n.length)&&this.emitSocket({type:y,ice:r});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleNegotiation",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("negotiation is needed on the client side"),e.next=3,this.pc.createOffer();case 3:return r=e.sent,e.next=6,this.pc.setLocalDescription(r);case 6:console.log("offer was created"),this.emitSocket({type:O,offer:r,circleId:this.group.circleId,groupId:this.group.id});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"initializePeerConnection",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({video:!1,audio:!0});case 2:t=e.sent,this.handleTrack(t,v.b.getLocalUser().id),this.localStream=t,this.pc=this.createPeerConnection(),this.pc.onicecandidateerror=function(e){console.error("local ice candidate error",e)},n=Object(a.a)(t.getTracks());try{for(n.s();!(r=n.n()).done;)c=r.value,this.pc.addTrack(c,t),console.log("adding track to stream",c)}catch(i){n.e(i)}finally{n.f()}case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleTrack",value:function(e,t){var n;if(console.log("handle track",t),t!==v.b.getLocalUser().id){var r="vc-aud-".concat(t),a=b.a.assign(null!==(n=document.getElementById(r))&&void 0!==n?n:document.createElement("audio"),{id:r,style:"display:none",volume:.5});console.log({audio:a,stream:e,userId:t}),document.body.appendChild(a),a.srcObject=e,a.autoplay=!0}}},{key:"disconnect",value:function(){var e=Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("should disconnect"),S.socket.removeEventListener("message",this.handleMessage),this.emitSocket({type:g}),f.b.dispatch({type:j.a.UPDATE_CURRENT_CALL,call:null}),S.currentRoom=null;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestConsumer",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var n,a,c,s=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("HANDLING CONSUMER",t),n=new RTCPeerConnection(T),b.a.extend(this.connections,Object(r.a)({},t,{pc:n})),a={direction:"recvonly"},n.addTransceiver("video",a),n.addTransceiver("audio",a),n.onicecandidate=function(e){var n,r=e.candidate;(null===r||void 0===r||null===(n=r.candidate)||void 0===n?void 0:n.length)&&s.emitSocket({type:E,ice:r,userId:t})},e.next=9,n.createOffer();case 9:return c=e.sent,e.next=12,n.setLocalDescription(c);case 12:n.onicecandidateerror=function(e){console.error("consumer ice candidate error",e)},n.ontrack=function(e){return s.handleTrack(e.streams[0],t)},this.emitSocket({type:C,userId:t,offer:c});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleMessage",value:function(e){var t=e.data,n=JSON.parse(t);switch(n.type){case x:var r=new RTCSessionDescription(n.answer);this.pc.setRemoteDescription(r).catch(console.error);break;case p:for(var c in this.connections)if(!~n.users.indexOf(c)&&(this.connections[c].pc.close(),delete this.connections[c],c===v.b.getLocalUser().id))for(var i in this.connections)this.connections[i].pc.close(),delete this.connections[i];var s,o=Object(a.a)(n.users);try{for(o.s();!(s=o.n()).done;){var u=s.value;u!==v.b.getLocalUser().id&&(this.connections[u]||this.requestConsumer(u).catch(console.error.bind(null,"Failed to request consumer!")))}}catch(j){o.e(j)}finally{o.f()}console.log(this.connections);break;case k:var l=new RTCSessionDescription(n.answer),d=b.a.get(this.connections,[n.userId],{}).pc;console.log("received consumer answer",d,n.userId),null===d||void 0===d||d.setRemoteDescription(l).catch(console.error.bind(null,"Failed to receive consumer!"))}}}]),e}();t.b=S}).call(this,n(52).setImmediate)},function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return D})),n.d(t,"a",(function(){return H}));var r=n(0),a=n.n(r),c=n(5),i=n(24),s=n(10),o=n(11),u=n(18),l=n(2),d=n(4),b=n(12),j=n.n(b),f=(n(111),n(147)),h=n(78),v=n(148),p=n(88),m=n(149),O=n(9),g=n(14),x=n(30),y=(n(28),n(16)),C=n(20),k=n(17),E=n(39),S=n(43),T=n(45),N=(n(3),n(32),n(37)),w=n(58),I=n(44),A=n(42),U=n(27),_=n(1),D=function(){function e(t){var n=this;Object(l.a)(this,e),this.id="",this.title="",this.Component=function(e){return Object(_.jsx)(P,Object(u.a)({group:n},e))},j.a.extend(this,t)}return Object(d.a)(e,[{key:"isNsfw",get:function(){return this.nsfw}},{key:"circle",get:function(){return E.a.getCircle(this.circleId)}},{key:"markAsRead",value:function(){this.isDm?N.a.markRead(this.groupId):N.a.markRead(this.circleId,this.id)}}]),e}();function P(e){var t=e.group,n=e.children,r=void 0===n?null:n;if(g.b.useForceUpdater(O.a.GROUP_UPDATE,(function(e){var t=e.circle,n=e.group;return t.id===n.circleId&&n.id===n.id})),t.isNsfw&&!S.b.isNsfwVerified)return null;switch(t.type){default:return null;case O.b.FOLDER:return Object(_.jsx)(L,{group:t,children:r});case O.b.TEXT:return Object(_.jsx)(R,{group:t});case O.b.VOICE:return Object(_.jsx)(B,{group:t});case O.b.ANNOUNCEMENTS:return Object(_.jsx)(W,{group:t})}}function L(e){var t=e.group,n=e.children;return Object(_.jsxs)("div",{className:"Group TypeFolder",children:[Object(_.jsxs)("div",{className:"Title",children:[Object(_.jsx)(f.a,{})," ",t.title]}),Object(_.jsx)("div",{className:"FolderContents",children:n})]})}function M(e){Object(x.c)(e.circle.lastLocation="app/circles/".concat(e.circleId,"/groups/").concat(e.id)),N.a.markRead(e.circle.id,e.id)}function R(e){var t=e.group,n={onClick:function(){return M(t)}};return Object(_.jsx)("div",{className:Object(O.i)("Group","TypeText",[C.a.getSelectedGroup()===t,"Selected"]),children:Object(_.jsxs)("div",Object(u.a)(Object(u.a)({className:"Title"},n),{},{children:[Object(_.jsx)(h.a,{})," ",t.title,Object(_.jsx)(F,{group:t})]}))})}function F(e){var t=e.group,n=N.a.useState((function(){return N.a.getUnreadMessageCount(t.circleId,t.id)})),r=I.a.useState((function(){return j.a.size(I.a.getTypingUsersForGroup(t.circleId,t.id))}));return Object(_.jsxs)("div",{className:"UnreadBlips Flex",children:[Object(_.jsx)(A.a,{style:{opacity:r?1:0}}),!!n&&Object(_.jsx)("div",{className:"Blip Unread",children:n>999?"".concat(Math.round(n/1e3),"k"):n})]})}function B(e){var t,n,r=e.group,a=w.a.useState((function(){return w.a.getVoiceMembers(r.circleId,r.id)}));return Object(_.jsxs)("div",{className:"Group TypeVoice",children:[Object(_.jsxs)("div",{className:"Title",children:[Object(_.jsx)(v.a,{})," ",r.title]}),Object(_.jsxs)("div",{className:"FolderContents",children:[Object(_.jsx)("div",{className:Object(O.i)("Group","TypeText",[C.a.getSelectedGroup()===r,"Selected"]),onClick:function(){M(r)},children:Object(_.jsxs)("div",{className:"Title",children:[Object(_.jsx)(h.a,{})," Text Chat",Object(_.jsx)(F,{group:r})]})}),Object(_.jsxs)("div",{className:Object(O.i)("Group","TypeText",[(null===(t=T.b.currentRoom)||void 0===t?void 0:t.group)===r,"Selected"]),onClick:function(){var e;(null===(e=T.b.currentRoom)||void 0===e?void 0:e.group.id)===r.id?Object(x.c)("#app/circles/".concat(r.circleId,"/call")):new T.a(r.circleId,r.id).connect()},children:[Object(_.jsxs)("div",{className:"Title",children:[Object(_.jsx)(p.a,{})," ",(null===(n=T.b.currentRoom)||void 0===n?void 0:n.group)===r?"Connected":"Join Room"]}),Object(_.jsx)("div",{className:"FolderContents",children:a&&a.map((function(e){return Object(_.jsx)(G,{userId:e},e)}))})]})]})]})}function G(e){var t=e.userId,n=T.b.currentRoom,r=y.b.useState((function(){return y.b.getUser(t)}));return console.log({room:n}),Object(_.jsx)("div",{className:"Group TypeText TypeUser",children:Object(_.jsxs)("div",{className:"Title",children:[Object(_.jsx)(r.AvatarComponent,{size:17}),r.displayName]})})}function W(e){var t=e.group;return Object(_.jsx)("div",{className:"Group TypeAnnouncement",children:Object(_.jsxs)("div",{className:"Title",children:[Object(_.jsx)(m.a,{})," ",t.title]})})}var H=function(t){Object(s.a)(r,t);var n=Object(o.a)(r);function r(){var e;Object(l.a)(this,r);for(var t=arguments.length,a=new Array(t),c=0;c<t;c++)a[c]=arguments[c];return(e=n.call.apply(n,[this].concat(a))).userId="",e.Component=function(){return Object(_.jsx)(V,{group:Object(i.a)(e)})},e.initTypingListener(),e}return Object(d.a)(r,[{key:"initTypingListener",value:function(){var t=Object(c.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.id){t.next=5;break}return t.next=3,new Promise(e);case 3:t.next=0;break;case 5:I.a.tryCreateListenerFor("dms",this.userId);case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"circleId",get:function(){return"dms"}},{key:"isNsfw",get:function(){return!1}},{key:"_ref",get:function(){return k.a.doc("directmessages",r.getId(this.userId))}}],[{key:"getId",value:function(e){var t;return(null===(t=y.b.getLocalUser())||void 0===t?void 0:t.id)||console.error("Attempting to get a DM group ID before the user is initialized!"),[y.b.getLocalUser().id,e].sort().join("_")}}]),r}(D);function V(e){var t=e.group,n=y.b.useState((function(){return y.b.getUser(t.userId)}));return(null===n||void 0===n?void 0:n.displayName)?Object(_.jsxs)(U.a.Wrapper,{menu:Object(_.jsx)(n.ContextMenu,{}),wrapperClassName:"DirectMessageGroup UserSection Flex",onClick:function(){return Object(x.c)("#app/dms/".concat(n.id))},children:[Object(_.jsx)(n.AvatarComponent,{size:30}),Object(_.jsxs)("div",{className:"Details",children:[Object(_.jsx)("h3",{className:"Username",children:n.displayName}),Object(_.jsx)(n.StatusText,{tooltipDirection:"none"})]})]}):null}}).call(this,n(52).setImmediate)},function(e,t,n){"use strict";n.d(t,"b",(function(){return N})),n.d(t,"a",(function(){return I}));var r=n(18),a=n(19),c=n(0),i=n.n(c),s=n(5),o=n(2),u=n(4),l=(n(110),n(12)),d=n.n(l),b=n(29),j=n(9),f=n(14),h=n(30),v=n(17),p=n(28),m=n(20),O=n(150),g=n(151),x=n(37),y=n(16),C=n(23),k=n(22),E=n(27),S=n(39),T=n(1),N=function(){function e(t){var n=this;Object(o.a)(this,e),this.id="",this.name="",this.iconUrl="",this._groups=null,this.BubbleComponent=function(){return Object(T.jsx)(I,{circle:n})},this.ContextMenu=function(){return Object(T.jsx)(w,{circle:n})},d.a.extend(this,t)}return Object(u.a)(e,[{key:"getGroups",value:function(){return m.a.getGroups(this.id)}},{key:"leaveCircle",value:function(){var e=Object(s.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.d)({title:"Are you sure?",description:"Leave <b>".concat(this.name,"</b>?")});case 2:if(e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,v.a.delete(v.a.doc("circles",this.id,"members",y.b.getLocalUser().id));case 7:return e.next=9,v.a.delete(v.a.doc("userdata",y.b.getLocalUser().id,"circles",this.id));case 9:window.location.href.includes(this.id)&&Object(h.c)("app"),C.a.showToast(Object(T.jsxs)("span",{children:["Left ",Object(T.jsxs)("b",{children:["$",this.name]})]})),S.a.destroyCircle(this.id);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderGroups",value:function(){var e=this.getGroups();if(e){var t=Object.values(e).sort((function(e,t){return e.position-t.position}));return[Object(T.jsx)("div",{className:Object(j.i)("Group TypeButton",["overview"===h.a[2],"Selected"]),children:Object(T.jsxs)("div",{className:"Title",onClick:function(){return Object(h.c)("#app/circles/".concat(h.a[1],"/overview"))},children:[Object(T.jsx)(O.a,{})," Overview"]})},"__overview")].concat(Object(a.a)(t.filter((function(t){return!t.parent||!e[t.parent]})).map((function e(n){return Object(T.jsx)(n.Component,{children:t.filter((function(e){return e.parent===n.id})).map(e)},n.id)}))))}}}],[{key:"join",value:function(){var e=Object(s.a)(i.a.mark((function e(t,n){var r,a,c,s,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:y.b.getLocalUser().id,a=v.a.doc("circles",t,"members",r),e.next=4,v.a.getDoc(a);case 4:if(!e.sent){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,v.a.set(a,{joinDate:Object(p.m)(),inviteId:n}).then((function(){return{error:null}})).catch((function(e){return{error:e}}));case 8:if(c=e.sent,!(s=c.error)){e.next=13;break}return C.a.showToast("There was an error joining circle","Failure"),e.abrupt("return",console.error("Error joining circle",s));case 13:return e.next=15,v.a.set(v.a.doc("userdata",r,"circles",t),{position:0});case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function w(e){var t=e.circle;return Object(T.jsx)(E.a,{children:Object(T.jsx)(E.a.Item,{icon:Object(T.jsx)(g.a,{}),style:{color:"var(--busy-color)"},autoClose:!0,onClick:t.leaveCircle.bind(t),children:"Leave"})})}function I(e){var t=e.circle,n=e.icon,a=void 0===n?null:n,c=e.onClick,i=void 0===c?null:c;f.b.useForceUpdater(j.a.CIRCLE_UPDATE,(function(e){return e.circle.id===t.id}));var s=x.a.useState((function(){return x.a.getUnreadMessageCount(t.id)})),o={onClick:function(){if(i)return i();var e=localStorage.getItem("lastGroup.".concat(t.id))||"overview";t.lastLocation?Object(h.c)(t.lastLocation):Object(h.c)("app/circles/".concat(t.id,"/").concat(e))}};return Object(T.jsx)(E.a.Wrapper,{menu:t instanceof N?Object(T.jsx)(t.ContextMenu,{}):null,children:Object(T.jsxs)("div",Object(r.a)(Object(r.a)({className:"Circle FlexCenter"},o),{},{children:[a||(t.iconUrl?Object(T.jsx)("img",{className:"Icon",src:t.iconUrl,alt:t.name}):Object(T.jsx)("h3",{className:"Icon Acronym",children:Object(j.g)(t.name)})),Object(T.jsx)("div",{className:"UnreadBlips Flex",children:s>0&&Object(T.jsx)("div",{className:"Blip Unread",children:s>999?"".concat(Math.round(s/1e3),"k"):s})}),Object(T.jsx)(b.a,{direction:"right",children:t.name})]}))})}},function(e,t,n){"use strict";var r=n(18),a=n(2),c=n(4),i=n(12),s=n.n(i),o=n(3),u=n.n(o),l=n(55),d=n(16),b=n(19),j=n(15),f=n(163),h=n(32),v=n(42),p=n(22),m=(n(114),n(1));function O(e){var t=e.src,n=(e.message,u.a.useState(!1)),r=Object(j.a)(n,2),a=r[0],c=r[1],i=u.a.useState(!1),s=Object(j.a)(i,2),o=s[0],l=s[1],d=Object(h.d)();return u.a.useEffect((function(){var e=Object.assign(document.createElement("img"),{style:"display:none",src:t,onload:function(){return d&&c(!0),e.remove()},onerror:function(){return d&&l(!0),e.remove()}});return document.body.appendChild(e),function(){return e.remove()}}),[t]),Object(m.jsx)("div",{className:"ImageContainer FlexCenter",onClick:function(){return Object(p.e)(t,(function(){return Object(b.a)(document.querySelectorAll(".ImageContainer > .Image")).reverse().map((function(e){return e.src}))}))},children:o?Object(m.jsxs)("div",{className:"FailedPlaceholder FlexCenter",children:[Object(m.jsx)(f.a,{}),Object(m.jsx)("h4",{children:"Image 404"})]}):a?Object(m.jsx)("img",{className:"Image",src:t}):Object(m.jsx)("div",{className:"LoadingPlaceholder FlexCenter",children:Object(m.jsx)(v.a,{})})})}var g=n(9),x=n(20),y=n(41),C=n(23);n(115);function k(e){var t,n,r=e.messageId,a=x.a.useState((function(){var e;return null!==(e=x.a.getSelectedGroup())&&void 0!==e?e:{}})),c=a.circleId,i=a.id,s=y.a.useState((function(){return y.a.getMessage(c,i,r)})),o=d.b.useState((function(){var e;return s&&(null===(e=d.b.getUser(s.senderId))||void 0===e?void 0:e.displayName)})),l=u.a.useState(!1),b=Object(j.a)(l,2),f=b[0],h=b[1];return Object(m.jsx)("div",{className:Object(g.i)("ReplyRenderer",[f,"Expanded"]),onClick:function(e){return e.target.matches(".ReplyRenderer, .ReplyRenderer > *, .ReplyRenderer > .Flex > *")&&h(!f)},style:{borderColor:null===(t=d.b.getUser(null===s||void 0===s?void 0:s.senderId))||void 0===t?void 0:t.getColor()},children:s?Object(m.jsxs)(u.a.Fragment,{children:[Object(m.jsxs)("div",{className:"Flex",children:[Object(m.jsx)("h4",{className:"Username",style:{color:null===(n=d.b.getUser(s.senderId))||void 0===n?void 0:n.getColor()},children:o}),Object(m.jsxs)("div",{onClick:function(){var e=document.querySelector('[data-message-id="'.concat(s.id,'"]'));if(e){var t=e.getBoundingClientRect();window.scrollTo({left:0,top:t.top,behavior:"smooth"}),e.classList.add("Highlight")}else C.a.showToast("Message could not be found!","Failure")},children:["said ",s.getCreationDate(),Object(m.jsx)("div",{children:"jump to message"})]})]}),Object(m.jsx)("div",{className:"MessageContent",children:T.parse(s.content,s,{minimal:!f})})]}):Object(m.jsx)("div",{className:"MessageContent Failed",children:"Message failed to load."})})}var E=n(50),S=10,T=t.a=new(function(){function e(){Object(a.a)(this,e),this.rules=s.a.extend({},l.defaultRules,{link:{order:l.defaultRules.link.order,match:l.defaultRules.link.match,parse:function(e,t,n){return{state:n,content:t(e[1],n),target:Object(l.unescapeUrl)(e[2])}},react:function(e,t,n){var r,a;return(null===e||void 0===e||null===(r=e.state)||void 0===r?void 0:r.minimal)?Object(m.jsx)("span",{className:"MinimalTag",children:"[link]"},n.key):e.content[0].content===e.target?Object(m.jsx)("a",{href:e.target,children:decodeURIComponent(e.target)}):(e.ref=null!==(a=e.ref)&&void 0!==a?a:u.a.createRef(),Object(m.jsx)("div",{className:"CustomLinkContainer",ref:e.ref,children:Object(m.jsx)("a",{href:e.target,children:e.content[0].content})}))}},image:{order:S++,match:function(e){return/^https:\/\/(\S?)+\.(jpe?g|png|gif|bmp)\S*(\s|$)/i.exec(e)},parse:function(e,t,n){return{src:e[0].trim(),message:null===n||void 0===n?void 0:n.message,state:n}},react:function(e,t,n){return e.state.minimal?Object(m.jsx)("span",{className:"MinimalTag",children:"[image]"},n.key):Object(m.jsx)(O,{src:e.src,message:e.message},n.key)}},video:{order:S++,match:function(e){return/^https:\/\/(\S?)+\.(mp4|webm)(\S?)+/.exec(e)},parse:function(e,t,n){return{src:e[0],state:n}},react:function(e,t,n){return e.state.minimal?Object(m.jsx)("span",{className:"MinimalTag",children:"[video]"},n.key):Object(m.jsx)("video",{src:e.src,controls:!0},n.key)}},userMention:{order:S++,match:function(e){return/^@(\S{28})/.exec(e)},parse:function(e,t,n){return{userId:e[1],state:n}},react:function(e,t,n){return u.a.createElement(d.b.getUser(e.userId).Mention,{key:n.key})}},emote:{order:S++,match:function(e){return/^:([^\/\s\\]+)\.([^\/\s\\]+):/.exec(e)},parse:function(e,t,n){return{packId:e[1],emoteId:e[2],src:e.src,state:n}},react:function(e,t,n){var r=E.a.getEmote(e.packId,e.emoteId);return r?u.a.createElement(r.Component,{key:n.key}):null}},audio:{order:S++,match:function(e){return/^https:\/\/(\S?)+\.(ogg|mp3|wav)(\S?)+/.exec(e)},parse:function(e,t,n){return{src:e[0],state:n}},react:function(e,t,n){return Object(m.jsx)("audio",{src:e.src,controls:!0},n.key)}},youtube:{order:S++,match:function(e){return/^https:\/\/((?:www|music)\.youtube\.com\/watch\?v=|youtu\.be\/)(\S+)/i.exec(e)},parse:function(e,t,n){return{id:e[2],state:n}},react:function(e,t,n){return Object(m.jsx)("iframe",{className:"YouTubeEmbed",src:"https://www.youtube.com/embed/".concat(e.id),allowFullScreen:!0},e.id)}},reply:{order:S++,match:function(e){return/^re:(\S{20}?)/.exec(e)},parse:function(e,t,n){return{messageId:e[1],state:n}},react:function(e,t,n){return e.state.minimal?Object(m.jsx)("span",{className:"MinimalTag",children:"[reply]"},n.key):Object(m.jsx)(k,{messageId:e.messageId},n.key)}},heading:{order:S++,match:function(e){return/^#h([1-4]) (.+)(?:$|\n)/.exec(e)},parse:function(e,t,n){return{sizeIndex:e[1],content:t(e[2]),state:n}},react:function(e,t,n){return e.state.minimal?Object(m.jsx)("b",{children:t(e.content)},n.key):Object(m.jsx)("b",{style:{fontSize:"".concat([2.5,2,1.6,1.2][e.sizeIndex-1],"em")},children:t(e.content)},n.key)}},color:{order:S++,match:function(e){return/^(#[a-f0-9]{6})# (.+)(?:$|\n)/i.exec(e)},parse:function(e,t,n){return{color:e[1],content:t(e[2],n)}},react:function(e,t,n){return Object(m.jsx)("span",{style:{color:e.color},children:t(e.content)},n.key)}}}),this.parser=Object(l.parserFor)(this.rules),this.render=Object(l.reactFor)(Object(l.ruleOutput)(this.rules,"react"))}return Object(c.a)(e,[{key:"parse",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.render(this.parser(e,Object(r.a)({inline:!0,message:t},n)))}}]),e}())},,function(e,t,n){"use strict";var r=n(8),a=n(0),c=n.n(a),i=n(18),s=n(5),o=n(2),u=n(4),l=n(10),d=n(11),b=n(12),j=n.n(b),f=n(9),h=n(17),v=n(14),p=n(26),m=n(56),O={},g=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"getEmote",value:function(e,t){var n;return null!==(n=j.a.get(O,[e,t]))&&void 0!==n?n:(this.fetchEmote(e,t),j.a.set(O,[e,t],new m.a({packId:e,id:t,loading:!0})),j.a.get(O,[e,t]))}},{key:"getCachedEmotes",value:function(){return O}},{key:"fetchEmote",value:function(){var e=Object(s.a)(c.a.mark((function e(t,n){var r,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getDoc(h.a.doc("emotepacks",t,"emotes",n));case 2:return a=e.sent,s=j.a.extend(null!==(r=j.a.get(O,[t,n]))&&void 0!==r?r:new m.a,Object(i.a)(Object(i.a)({},a),{},{packId:t,loading:!1})),v.b.dispatch({type:f.a.FETCH_EMOTE,packId:t,emoteId:n,emote:s}),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(p.a),x=new g(v.b,Object(r.a)({},f.a.FETCH_EMOTE,(function(e){var t=e.packId,n=e.emoteId,r=e.emote;j.a.set(O,[t,n],j.a.extend(j.a.get(O,[t,n]),r))})));t.a=x},function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return x}));var r,a=n(8),c=n(15),i=n(2),s=n(4),o=n(24),u=n(10),l=n(11),d=n(12),b=n.n(d),j=n(3),f=n.n(j),h=n(9),v=n(17),p=n(14),m=n(26),O=n(16),g={"group-panel-size":250};function x(e){return e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase()}var y=function(t){Object(u.a)(r,t);var n=Object(l.a)(r);function r(){var t;Object(i.a)(this,r);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];t=n.call.apply(n,[this].concat(c));var u=function e(){O.b.getLocalUser()&&(t._databaseReference=v.a.doc("usersettings",O.b.getLocalUser().id,"v2","cssVars"),v.a.getDoc(t._databaseReference).then((function(e){t._hasLoaded=!0,p.b.dispatch({type:h.a.BATCH_UPDATE_CSS_VARS,entries:null!==e&&void 0!==e?e:{}})})),O.b.removeListener(e))};return e((function(){return O.b.addListener(u)})),t._save=b.a.debounce(t._save.bind(Object(o.a)(t)),5e3),t}return Object(s.a)(r,[{key:"_save",value:function(){this._hasLoaded&&v.a.set(this._databaseReference,g).catch((function(e){return console.error("Error saving CSS variables!",e.stack)}))}},{key:"getStyle",value:function(e){return g[x(e)]}},{key:"getStyles",value:function(){return g}},{key:"Renderer",get:function(){return function(){return p.b.useForceUpdater(h.a.UPDATE_CSS_VAR),p.b.useForceUpdater(h.a.BATCH_UPDATE_CSS_VARS),f.a.createElement("style",{},"#root {\n\t\t\t\t\t".concat(Object.entries(g).map((function(e){var t=Object(c.a)(e,2),n=t[0],r=t[1];return"--".concat(n,": ").concat(r,";")})).join("\n"),"\n\t\t\t\t}"))}}}]),r}(m.a),C=new y(p.b,(r={},Object(a.a)(r,h.a.UPDATE_CSS_VAR,(function(e){var t=e.key,n=e.value;g[x(t)]=n,C._save()})),Object(a.a)(r,h.a.BATCH_UPDATE_CSS_VARS,(function(e){var t=e.entries;for(var n in t){var r=["string","number"];~r.indexOf(typeof n)&&~r.indexOf(typeof t[n])&&(g[n]=t[n])}})),r));t.a=C}).call(this,n(52).setImmediate)},,,function(e,t,n){"use strict";var r=n(0),a=n.n(r),c=n(5),i=n(18),s=n(2),o=n(4),u=n(60),l=n(12),d=n.n(l);t.a=new(function(){function e(){Object(s.a)(this,e),this.db=Object(u.b)()}return Object(o.a)(e,[{key:"serializeObject",value:function(e){return d.a.omit(Object(i.a)({},e),["_ref","_unbindListener","id"])}},{key:"ref",value:function(e){return Object(u.e)(this.db,e)}},{key:"createListener",value:function(e,t){return Object(u.d)(this.ref(e),t)}},{key:"createDisconnectListener",value:function(e){return Object(u.c)(this.ref(e))}},{key:"get",value:function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.a)(this.ref(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"set",value:function(){var e=Object(c.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.f)(this.ref(t),n?this.serializeObject(n):null);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}())},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(15),a=n(2),c=n(12),i=n.n(c),s=n(3),o=n.n(s),u=(n(9),n(14),n(50)),l=(n(116),n(1)),d=function e(t){var n=this;Object(a.a)(this,e),this.Component=function(){return Object(l.jsx)(b,{emote:n})},i.a.extend(this,t)};function b(e){var t=e.emote,n=o.a.useRef(),a=o.a.useState("1.25em"),c=Object(r.a)(a,2),i=c[0],s=c[1],d=u.a.useState((function(){return t.url}));return o.a.useEffect((function(){var e,t;1===(null===(e=n.current)||void 0===e||null===(t=e.parentElement)||void 0===t?void 0:t.childNodes.length)&&s("4em")}),[]),Object(l.jsx)("div",{className:"Emote",ref:n,style:{width:i,height:i},children:Object(l.jsx)("img",{className:"EmoteImage",src:d,alt:""})})}},function(e,t,n){"use strict";var r=n(8),a=n(13),c=n(15),i=n(2),s=n(4),o=n(10),u=n(11),l=n(12),d=n.n(l),b=n(9),j=n(14),f=n(26),h=(n(16),{}),v=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(s.a)(n,[{key:"getReads",value:function(e,t){return d.a.get(h,[e,t])}},{key:"getReadsForMessage",value:function(e,t,n){var r,a=null!==(r=this.getReads(e,t))&&void 0!==r?r:{};return Object.entries(a).filter((function(e){return Object(c.a)(e,2)[1].messageId===n})).map((function(e){var t=Object(c.a)(e,2);return{userId:t[0],timestamp:t[1].timestamp}}))}},{key:"getAllCachedReads",value:function(){return h}}]),n}(f.a),p=new v(j.b,Object(r.a)({},b.a.UPDATE_READS,(function(e){var t=e.circleId,n=e.groupId,r=e.reads;d.a.get(h,[t,n])||d.a.set(h,[t,n],{});var c,i=Object(a.a)(r);try{for(i.s();!(c=i.n()).done;){var s=c.value;h[t][n][s.id]=d.a.pick(s,"messageId","timestamp")}}catch(o){i.e(o)}finally{i.f()}})));t.a=p},function(e,t,n){"use strict";var r=n(8),a=n(13),c=n(2),i=n(4),s=n(10),o=n(11),u=n(12),l=n.n(u),d=n(9),b=n(14),j=n(26),f=n.p+"static/media/ascend.05fa505d.ogg",h=n.p+"static/media/descend.98a1480b.ogg",v=n(45),p={},m=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"getVoiceMembers",value:function(e,t){return l.a.get(p,[e,t])}},{key:"getAllVoiceMembers",value:function(){return p}}]),n}(j.a),O=new m(b.b,Object(r.a)({},d.a.UPDATE_VOICE_MEMBERS,(function(e){var t,n=e.circleId,r=e.groupId,c=e.users,i=l.a.get(p,[n,r],[]);if((null===(t=v.b.currentRoom)||void 0===t?void 0:t.group.id)===r){var s,o=Object(a.a)(i);try{for(o.s();!(s=o.n()).done;){var u=s.value;~c.indexOf(u)||Object(d.l)(h,.5)}}catch(O){o.e(O)}finally{o.f()}var b,j=Object(a.a)(c);try{for(j.s();!(b=j.n()).done;){var m=b.value;~i.indexOf(m)||Object(d.l)(f,.5)}}catch(O){j.e(O)}finally{j.f()}}l.a.set(p,[n,r],c)})));t.a=O},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(2),a=n(4),c=n(10),i=n(11),s=n(3),o=n.n(s),u=(n(98),n(22)),l=n(1),d=function(e){Object(c.a)(n,e);var t=Object(i.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).state={error:null,errorInfo:null,moreInfo:!1},a}return Object(a.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"showErrorInfo",value:function(){var e=this.state,t=e.error,n=e.errorInfo;Object(u.f)(Object(l.jsxs)("div",{className:"ErrorInfoModal PrimaryBg",onClick:function(){return Object(u.b)()},children:[Object(l.jsx)("h1",{children:t.message}),n.componentStack.split("\n").slice(0,10).map((function(e,t){return Object(l.jsx)("h2",{children:e},t)}))]}))}},{key:"renderError",value:function(){var e=this;this.state.moreInfo;return Object(l.jsxs)("div",{className:"ErrorBoundaryHandler",children:[Object(l.jsx)("h1",{children:"There was an error with this component!"}),Object(l.jsx)("h2",{children:"This is due to a plugin error or application error."}),Object(l.jsxs)("div",{className:"ErrorBoundaryFooter",children:[Object(l.jsx)("div",{className:"ErrorBoundaryButton TertiaryBg",onClick:function(){return e.showErrorInfo()},children:"More Info"}),Object(l.jsx)("div",{className:"ErrorBoundaryButton BackgroundDanger",onClick:function(){return e.setState({error:null})},children:"Retry"})]})]})}},{key:"render",value:function(){return this.state.error?this.renderError():this.props.children}}]),n}(o.a.Component)},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return C}));var r=n(18),a=n(12),c=n.n(a),i=n(3),s=n.n(i),o=n(137),u=n(9),l=n(14),d=n(32),b=n(51),j=n(20),f=n(57),h=n(41),v=n(16),p=n(43),m=n(27),O=n(42),g=n(29),x=(n(118),n(1));function y(e){var t=e.circleId,n=e.groupId;l.b.useForceUpdater(u.a.CHAT_UPDATE,(function(e){return e.circleId==t&&e.groupId==n}));var a=s.a.useRef(),i=h.a.getMessageGroups(t,n),o=Object(d.c)("max-width",700),j=s.a.useMemo((function(){return o?{onTouchStart:function(e){var t=e.touches[0].clientX,n=e.touches[0].clientY,r=b.a.getStyle("groupPanelSize")+60,i=0,s=parseFloat(a.current.style.transform.match(/[0-9]+/g));isNaN(s)&&(s=0);var o,u=function(e){i=e.touches[0].clientX-t,Math.abs(i)<50||Math.abs(e.touches[0].clientY-n)>50||(i<0?i+=50:i-=50,Object.assign(a.current.style,{transform:"translateX(".concat(c.a.clamp(s+i,0,r),"px)")}))};document.addEventListener("touchmove",u),document.addEventListener("touchend",o=function(){setTimeout((function(){Object.assign(a.current.style,{transform:i>r/3?"translateX(".concat(r,"px)"):"none"}),document.removeEventListener("touchmove",u),document.removeEventListener("touchend",o)}),100)})}}:{}}),[o]);return Object(d.b)((function(){return h.a.tickCache(t,n)}),1e3,!0,[t,n]),Object(x.jsx)("div",Object(r.a)(Object(r.a)({className:"Panel PanelChat",ref:a},j),{},{children:i?Object(x.jsx)("div",{className:"Messages",children:i.map((function(e){return Object(x.jsx)(C,Object(r.a)({},e))}))}):Object(x.jsx)("div",{className:"FlexCenter",style:{marginTop:50},children:Object(x.jsx)(O.a,{})})}))}function C(e){var t,n=e.userId,r=e.messages,a=e.minimal,c=void 0!==a&&a,i=v.b.useState((function(){return v.b.getUser(n)}));return Object(x.jsxs)("div",{className:Object(u.i)("MessageGroup",[n===(null===(t=v.b.getLocalUser())||void 0===t?void 0:t.id),"LocalUser"]),children:[Object(x.jsxs)(m.a.Wrapper,{menu:Object(x.jsx)(i.ContextMenu,{}),wrapperClassName:"UserSection Flex",children:[i&&Object(x.jsx)(i.AvatarComponent,{}),Object(x.jsxs)("div",{className:"Details",children:[Object(x.jsx)("h3",{className:"Username",style:{color:i.getColor()},children:i.displayName}),Object(x.jsx)(i.StatusText,{})]})]}),r.map((function(e){return Object(x.jsx)(k,{message:e,minimal:c},e.id)}))]})}function k(e){var t,n=e.message,a=e.minimal,c=void 0!==a&&a,i=j.a.getSelectedGroup();l.b.useForceUpdater(u.a.UPDATE_READS,(function(e){var t=e.circleId,n=e.groupId;return(null===i||void 0===i?void 0:i.circleId)===t&&(null===i||void 0===i?void 0:i.id)===n}));var s=f.a.getReadsForMessage(null===i||void 0===i?void 0:i.circleId,null===i||void 0===i?void 0:i.id,n.id).filter((function(e){return e.userId!==v.b.getLocalUser().id})),d={onClick:function(e){e.shiftKey&&l.b.dispatch({type:u.a.RTA_APPEND_TEXT,text:" re:".concat(n.id," ")})}};return Object(x.jsxs)(m.a.Wrapper,{menu:Object(x.jsx)(n.ContextMenu,{}),wrapperClassName:"Message Flex","data-message-id":n.id,children:[Object(x.jsxs)("div",{className:"TimestampContainer",children:[Object(x.jsx)("span",{className:"Timestamp",children:null===(t=n.creationDate)||void 0===t?void 0:t.toDate().toLocaleTimeString("en-US",{hour12:!1}).slice(0,-3)}),Object(x.jsxs)(g.a,{direction:"right",children:[Object(x.jsxs)("div",{children:["Sent ",n.getCreationDate()]}),n.editedAt&&Object(x.jsxs)("div",{children:["Edited ",n.getCreationDate(n.editedAt)]})]})]}),Object(x.jsx)("div",Object(r.a)(Object(r.a)({className:"MessageContent"},d),{},{children:n.getContent({minimal:c})})),!!s.length&&Object(x.jsxs)("div",{className:"ReadIndicators",children:[Object(x.jsx)(o.a,{className:"Icon"}),Object(x.jsxs)(g.a,{direction:"left",children:[Object(x.jsx)("h4",{children:"Read by"}),Object(x.jsx)("div",{className:"Flex Indicators",children:s.map((function(e){var t=e.userId,n=e.timestamp;return Object(x.jsxs)("div",{children:[Object(x.jsx)(p.a,{user:v.b.getUser(t)})," ",Object(u.f)(n)]},t)}))})]})]})]})}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(2),a=n(4),c=n(12),i=n.n(c),s=n(3),o=n.n(s),u=n(135),l=n(136),d=n(27),b=n(9),j=n(14),f=n(48),h=n(20),v=n(16),p=n(1),m=function(){function e(t){var n=this;Object(r.a)(this,e),this.id="",this.content="",this.senderId="",this.creationDate=null,this.mentions=[],this.ContextMenu=function(){return Object(p.jsx)(O,{message:n})},i.a.extend(this,t)}return Object(a.a)(e,[{key:"getContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f.a.parse(this.content,this,e)}},{key:"getCreationDate",value:function(e){return Object(b.f)(null!==e&&void 0!==e?e:this.creationDate)}}]),e}();function O(e){var t=e.message,n=h.a.getSelectedGroup(),r=v.b.getLocalUser(),a=(null===t||void 0===t?void 0:t.senderId)===r.id;return Object(p.jsxs)(d.a,{children:[a&&Object(p.jsxs)(o.a.Fragment,{children:[Object(p.jsx)(d.a.Item,{style:{color:"var(--busy-color)"},icon:Object(p.jsx)(u.a,{}),autoClose:!0,onClick:function(){return j.b.dispatch({type:b.a.DELETE_MESSAGE,messageId:t.id,group:n})},children:"Delete"}),Object(p.jsx)(d.a.Divider,{})]}),Object(p.jsx)(d.a.Item,{icon:Object(p.jsx)(l.a,{}),autoClose:!0,onClick:function(){return j.b.dispatch({type:b.a.RTA_APPEND_TEXT,text:" re:".concat(t.id," ")})},children:"Reply"})]})}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var r,a=n(18),c=n(8),i=n(0),s=n.n(i),o=n(5),u=n(15),l=n(12),d=n.n(l),b=n(3),j=n.n(b),f=(n(117),n(9)),h=n(32),v=n(48),p=n(14),m=n(17),O=n(16),g=n(20),x=n(85),y=n(1);function C(t){var n,i=j.a.useRef(),l=j.a.useRef(),b=j.a.useRef(),C=j.a.useState(0),k=Object(u.a)(C,2),E=k[0],S=k[1],T=j.a.useState(null!==(n=t.defaultValue)&&void 0!==n?n:""),N=Object(u.a)(T,2),w=N[0],I=N[1],A=j.a.useState(!1),U=Object(u.a)(A,2),_=U[0],D=U[1],P=j.a.useState([0,0]),L=Object(u.a)(P,2),M=L[0],R=L[1],F=j.a.useMemo((function(){return Object(y.jsx)("div",{className:"Caret"},Object(f.h)())}),[w,M]),B={onInput:function(e){var n;null===(n=t.onInput)||void 0===n||n.call(t,e),I(e.target.value)},onKeyDown:function(){var e=Object(o.a)(s.a.mark((function e(n){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(r=t.onKeyDown)||void 0===r||r.call(t),e.t0=n.key,e.next="Enter"===e.t0?4:13;break;case 4:if(n.shiftKey){e.next=12;break}return n.preventDefault(),e.next=8,null===(a=t.onSend)||void 0===a?void 0:a.call(t,w);case 8:if(e.t1=e.sent,!0!==e.t1){e.next=12;break}I(""),b.current.value="";case 12:return e.abrupt("break",13);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),onFocus:function(){return D(!0),r=b.current},onBlur:function(){return D(!1)}};return j.a.useEffect((function(){var t;r=b.current,e((function(){var e;return S(null===(e=l.current)||void 0===e?void 0:e.getBoundingClientRect().height)}));var n=(t={},Object(c.a)(t,f.a.RTA_ATTACH_FILE,(function(e){var t=e.file;if(r===b.current){var n,a,c=O.b.getLocalUser(),i=null!==(n=g.a.getSelectedGroup())&&void 0!==n?n:{circleId:"default",id:"default"};m.a.uploadStorage(t,"gs://cirlos","files",i.circleId,null!==(a=i.groupId)&&void 0!==a?a:i.id,c.id,"".concat(Date.now(),"_").concat(t.name)).then((function(e){var t=e.url,n="".concat(b.current.value," ").concat(t," ");B.onInput({target:{value:n}}),b.current.value=n,I(n)}))}})),Object(c.a)(t,f.a.RTA_APPEND_TEXT,(function(e){var t=e.text;if(r===b.current){var n="".concat(b.current.value).concat(t).trimStart();B.onInput({target:{value:n}}),setTimeout((function(){b.current&&(b.current.setSelectionRange(-1,-1),b.current.focus())}),50),b.current.value=n,I(n)}})),Object(c.a)(t,f.a.RTA_SET_TEXT,(function(e){var t=e.text;if(r===b.current){var n=t;B.onInput({target:{value:n}}),setTimeout((function(){b.current&&(b.current.setSelectionRange(-1,-1),b.current.focus())}),50),b.current.value=n,I(n)}})),t);for(var a in n)p.b.subscribe(a,n[a]);return function(){for(var e in n)p.b.unsubscribe(e,n[e])}}),[w]),Object(h.a)("selectionchange",(function(){var e=document.getSelection();(null===e||void 0===e?void 0:e.anchorNode)===i.current&&R([b.current.selectionStart,b.current.selectionEnd])})),Object(y.jsxs)("div",{ref:i,className:Object(f.i)("RichTextArea",[_,"Focused"]),onClick:function(){return e((function(){return b.current.focus()}))},style:{"--rich-text-height":"".concat(E,"px")},children:[t.containerChildren,Object(y.jsx)(x.a,{value:w}),Object(y.jsx)("textarea",Object(a.a)(Object(a.a)({ref:b},d.a.omit(t,"children","onInput","onChange","onSend","onKeyDown","containerChildren")),B)),w?Object(y.jsxs)("div",{className:"Renderer",ref:l,children:[v.a.parse(w.slice(0,M[0])),M[1]-M[0]>0&&Object(y.jsx)("span",{className:"SelectedText",children:w.slice(M[0],M[1])}),F,v.a.parse(w.slice(M[1]))]}):Object(y.jsxs)("div",{className:"Renderer Placeholder",ref:l,children:[F,t.children]})]})}}).call(this,n(52).setImmediate)},,,,,,function(e,t,n){"use strict";var r,a=n(8),c=n(18),i=n(13),s=n(0),o=n.n(s),u=n(5),l=n(2),d=n(4),b=n(24),j=n(10),f=n(11),h=n(12),v=n.n(h),p=n(9),m=n(17),O=n(14),g=n(26),x=n(56),y=n(50),C=n(16),k={default:{filter:[]}},E=function(e){Object(j.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(l.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return e=t.call.apply(t,[this].concat(a)),Object(C.a)().then((function(t){e._filtersReference=m.a.doc("usersettings",t.id,"v2","emotes"),m.a.getDoc(e._filtersReference).then((function(t){e._hasLoaded=!0,O.b.dispatch({type:p.a.UPDATE_EMOTE_FILTERS,packs:null!==t&&void 0!==t?t:{}})})),new Promise(Object(u.a)(o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._hasLoaded){t.next=5;break}return t.next=3,new Promise((function(e){return setTimeout(e,200)}));case 3:t.next=0;break;case 5:for(n in k)e.fetchEmotePack(n);case 6:case"end":return t.stop()}}),t)}))))})),e._save=v.a.debounce(e._save.bind(Object(b.a)(e)),5e3),e}return Object(d.a)(n,[{key:"_save",value:function(){if(this._hasLoaded){var e={};for(var t in k)v.a.get(k,[t,"filter"])&&(e[t]=k[t].filter);m.a.set(this._filtersReference,e).catch(console.error.bind(null,"Failed to save emote filter settings!"))}}},{key:"getEmotePack",value:function(e){return v.a.get(k,[e],(this.fetchEmotePack(e),v.a.set(k,[e],{}),{}))}},{key:"getCachedEmotePacks",value:function(){return k}},{key:"getLocalEmotePacks",value:function(){var e=[];for(var t in k)v.a.get(k,[t,"filter"])&&e.push(t);return v.a.pick.apply(v.a,[k].concat(e))}},{key:"fetchEmotePack",value:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v.a.get(k,[t,"_unbindPackListener"])){e.next=2;break}return e.abrupt("return");case 2:n=m.a.createSnapshotListener(m.a.doc("emotepacks",t),(function(e){v.a.extend(k[t],e),null==e&&(n(),r())})),r=m.a.createSnapshotListener(m.a.collection("emotepacks",t,"emotes"),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.items,r=void 0===n?[]:n;O.b.dispatch({type:p.a.UPDATE_EMOTE_PACK,packId:t,emotes:r})})),v.a.extend(k[t],{_unbindPackListener:n,_unbindEmotesListener:r});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(g.a),S=new E(O.b,(r={},Object(a.a)(r,p.a.UPDATE_EMOTE_FILTERS,(function(e){var t=e.filters;for(var n in t)t[n]&&v.a.set(k,[n,"filter"],t[n])})),Object(a.a)(r,p.a.UPDATE_EMOTE_PACK,(function(e){var t,n=e.packId,r=e.emotes,a=Object(i.a)(r);try{for(a.s();!(t=a.n()).done;){var s=t.value;v.a.set(y.a.getCachedEmotes(),[n,s.id],new x.a(Object(c.a)(Object(c.a)({},s),{},{packId:n})))}}catch(o){a.e(o)}finally{a.f()}v.a.set(k,[n,"emotes"],y.a.getCachedEmotes()[n])})),r));t.a=S},,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var r=n(0),a=n.n(r),c=n(5),i=n(15),s=n(3),o=n.n(s),u=(n(109),n(138)),l=n(89),d=n(152),b=n(153),j=n(154),f=n(22),h=n(23),v=n(65),p=n(17),m=n(32),O=n(30),g=n(28),x=n(47),y=n(1);function C(t){var n=t.signUp,r=void 0!==n&&n,s=o.a.useState(r),C=Object(i.a)(s,2),k=C[0],E=C[1],S=o.a.useState(!1),T=Object(i.a)(S,2),N=T[0],w=T[1],I=o.a.useRef(),A={handleSignUp:function(){if(!N){var t=I.current.getElementsByTagName("input"),n=Object(i.a)(t,4),r=n[0],s=n[1],o=n[2],u=n[3];if(!r.value)return h.a.showToast("You must specify a username","Failure");if(u.value!==o.value)return h.a.showToast("Passwords must match","Failure");if(!s.value.trim())return h.a.showToast("You must input an email address","Failure");if(!o.value.trim())return h.a.showToast("You must input a password","Failure");w(!0),Object(v.a)(p.a.auth,s.value,o.value).then(function(){var t=Object(c.a)(a.a.mark((function t(n){var c,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=n.user,i=r.value,t.next=4,Object(v.d)(c,{displayName:i});case 4:return t.next=6,p.a.set(p.a.doc("userdata",c.uid),{displayName:i,normalizedName:i.toLowerCase(),creationDate:Object(g.m)()});case 6:return t.next=8,x.b.join("Kz9IW6QOJjdKC5oaT3lK","cirlos-official",c.uid);case 8:f.a.pop(),h.a.showToast("Welcome to Cirlos!","Success"),e((function(){return Object(O.c)("app")}));case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){h.a.showToast("An unknown error has occurred! Check console for details","Failure"),console.error(e)}))}},handleLogIn:function(){if(!N){var t=I.current.getElementsByTagName("input"),n=Object(i.a)(t,2),r=n[0],a=n[1];w(!0),Object(v.c)(p.a.auth,r.value,a.value).then((function(){return f.a.pop(),e((function(){return Object(O.c)("app")}))})).catch((function(e){var t="Unknown";switch(e.code){case"auth/invalid-email":t="Invalid email address";break;case"auth/user-not-found":t="No user with this email found";break;case"auth/wrong-password":t="Incorrect password"}h.a.showToast("Failed to sign in! Reason - ".concat(t),"Failure",10),console.error(e)}))}}};return Object(m.a)("keydown",(function(e){return"Enter"===e.key&&(k?A.handleSignUp():A.handleLogIn())})),Object(y.jsxs)("div",{className:"AuthModal",ref:I,children:[Object(y.jsx)(u.a,{className:"CloseButton",onClick:f.a.pop.bind(f.a)}),k?Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsxs)("div",{className:"MainSection Flex",children:[Object(y.jsxs)("div",{className:"HelpSection",children:[Object(y.jsx)("div",{className:"Title",children:"NOTE"}),Object(y.jsxs)("div",{children:["By creating an account,",Object(y.jsx)("br",{}),"you agree to the following:",Object(y.jsx)("br",{}),Object(y.jsx)("a",{href:"/terms",children:"Terms of Service"}),Object(y.jsx)("br",{}),Object(y.jsx)("a",{href:"/guidelines",children:"Community Guidelines"}),Object(y.jsx)("br",{}),Object(y.jsx)("a",{href:"/privacy",children:"Privacy Policy"}),Object(y.jsx)("br",{})]})]}),Object(y.jsxs)("div",{className:"Fields",children:[Object(y.jsx)("h3",{children:"Sign Up"}),Object(y.jsx)("div",{className:"FieldContainer",children:Object(y.jsx)("input",{type:"username",placeholder:"Username",maxLength:32})}),Object(y.jsx)("div",{className:"FieldContainer",children:Object(y.jsx)("input",{type:"email",placeholder:"Email Address"})}),Object(y.jsx)("div",{className:"FieldContainer",children:Object(y.jsx)("input",{type:"password",placeholder:"Password"})}),Object(y.jsx)("div",{className:"FieldContainer",children:Object(y.jsx)("input",{type:"password",placeholder:"Confirm Password"})})]})]}),Object(y.jsxs)("div",{className:"FooterSection Flex",children:[Object(y.jsxs)("div",{className:"Button",onClick:function(){return E(!1)},children:[Object(y.jsx)(l.a,{}),Object(y.jsx)("div",{children:"Already have an account?"})]}),Object(y.jsxs)("div",{className:"Button",style:{marginLeft:"auto"},onClick:A.handleSignUp,children:[Object(y.jsx)(d.a,{}),Object(y.jsx)("div",{children:"Sign Up"})]})]})]}):Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsxs)("div",{className:"MainSection Flex",children:[Object(y.jsxs)("div",{className:"HelpSection",children:[Object(y.jsx)("div",{className:"Title",children:"Log In"}),Object(y.jsx)("div",{children:"Welcome back to Cirlos."})]}),Object(y.jsxs)("div",{className:"Fields",children:[Object(y.jsx)("h3",{children:"Login"}),Object(y.jsx)("div",{className:"FieldContainer",children:Object(y.jsx)("input",{type:"email",placeholder:"Email Address"})}),Object(y.jsx)("div",{className:"FieldContainer",children:Object(y.jsx)("input",{type:"password",placeholder:"Password"})})]})]}),Object(y.jsxs)("div",{className:"FooterSection Flex",children:[Object(y.jsxs)("div",{className:"Button",onClick:function(){return E(!0)},children:[Object(y.jsx)(b.a,{}),Object(y.jsx)("div",{children:"Don't have an account?"})]}),Object(y.jsxs)("div",{className:"Button",style:{marginLeft:"auto"},children:[Object(y.jsx)(j.a,{}),Object(y.jsx)("div",{children:"Reset Password"})]}),Object(y.jsxs)("div",{className:"Button",onClick:A.handleLogIn,children:[Object(y.jsx)(l.a,{}),Object(y.jsx)("div",{children:"Log In"})]})]})]})]})}}).call(this,n(52).setImmediate)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(15),a=n(12),c=n.n(a),i=(n(3),n(9)),s=n(14),o=(n(32),n(76)),u=n(20),l=n(41),d=n(16),b=n(64),j=(n(119),n(1));function f(e){var t=e.value,n=t.split(/\s/g).slice(-1)[0],a=[];function f(e){var n,r;s.b.dispatch({type:i.a.RTA_SET_TEXT,text:"".concat(null!==(n=null===(r=t.match(/^.*\s/gm))||void 0===r?void 0:r[0])&&void 0!==n?n:""," ").concat(e," ")})}var h={replies:function(){var e,t,c=null===(e=n.match(/re:(\S*)/gm))||void 0===e?void 0:e[0];if(c){var i=u.a.getSelectedGroup();if(i){var s=c.split("re:"),o=Object(r.a)(s,2)[1],h=Object.values(null!==(t=l.a.getMessages(i.circleId,i.id))&&void 0!==t?t:{}).filter((function(e){var t=o.toLowerCase();return!t||(!!d.b.getUser(e.senderId).displayName.toLowerCase().includes(t)||!!e.content.toLowerCase().includes(t))}));h.reverse(),h.length=5,h.reverse(),a=h.map((function(e){return Object(j.jsx)("div",{className:"AutoCompleteItem ReplyItem",onClick:f.bind(null,"re:".concat(e.id)),children:Object(j.jsx)(b.a,{userId:e.senderId,messages:[e],minimal:!0})},e.id)}))}}},emotes:function(){var e;if(null===(e=n.match(/:(\S*)/gm))||void 0===e?void 0:e[0]){var t=n.toLowerCase().slice(1),r=o.a.getLocalEmotePacks(),i=c.a.flatten(Object.values(r).map((function(e){return Object.values(e.emotes)}))).filter((function(e){var n,r;return!!(null===(n=e.packId)||void 0===n?void 0:n.toLowerCase().includes(t))||!!(null===(r=e.id)||void 0===r?void 0:r.toLowerCase().includes(t))}));i.length=10,a=i.map((function(e){return Object(j.jsxs)("div",{className:"AutoCompleteItem EmoteItem FlexCenter",onClick:f.bind(null,":".concat(e.packId,".").concat(e.id,":")),children:[Object(j.jsx)(e.Component,{}),Object(j.jsx)("h4",{children:e.id}),Object(j.jsx)("div",{className:"PackId",children:e.packId})]},e.id)}))}}};for(var v in h)a.length||h[v]();return Object(j.jsx)("div",{className:"MarkdownAutoComplete",children:a})}},function(e,t,n){"use strict";t.a=n.p+"static/media/Logo.8c80fb7a.svg"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return C}));var r=n(15),a=n(0),c=n.n(a),i=n(5),s=n(3),o=n.n(s),u=n(155),l=n(156),d=n(78),b=n(157),j=n(9),f=n(14),h=n(48),v=n(20),p=n(44),m=n(16),O=n(43),g=n(23),x=(n(122),n(70)),y=n(1);function C(){f.b.useForceUpdater(j.a.PAGE_UPDATE);v.a.useState((function(){return v.a.getSelectedGroup()}));var t={handleSend:function(){var t=Object(i.a)(c.a.mark((function t(n){var r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.trim()){t.next=6;break}if(r=v.a.getSelectedGroup()){t.next=4;break}return t.abrupt("return",g.a.showToast("No selected group!","Failure"));case 4:f.b.dispatch({type:j.a.SEND_MESSAGE,group:r,content:n}),p.a.stopTyping(r.circleId,r.id);case 6:return e((function(){var e;null===(e=document.getElementById("ChatTextArea"))||void 0===e||e.focus()})),t.abrupt("return",!0);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};return Object(y.jsxs)("div",{className:"ChatTextAreaContainer Flex",children:[Object(y.jsxs)(x.a,{id:"ChatTextArea",className:"ChatTextArea",onSend:t.handleSend,onInput:function(e){return e.target.value?p.a.startTyping():p.a.stopTyping()},containerChildren:Object(y.jsx)(E,{}),disabled:!v.a.getSelectedGroup(),children:[Object(y.jsx)(k,{})," "]}),Object(y.jsx)("div",{className:"Button",onClick:function(){return Object(j.k)().then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(r.a)(e,1),n=t[0];return n&&f.b.dispatch({type:j.a.RTA_ATTACH_FILE,file:n})}))},children:Object(y.jsx)(u.a,{})}),Object(y.jsx)("div",{className:"Button",onClick:function(){return document.getElementById("ChatTextArea").dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",shiftKey:!1,bubbles:!0}))},children:Object(y.jsx)(l.a,{})})]})}function k(){var e=v.a.getSelectedGroup();if(f.b.useForceUpdater(j.a.GROUP_UPDATE,(function(t){return e&&t.circle.id===e.circleId&&t.group.id===e.id})),f.b.useForceUpdater(j.a.USER_UPDATE,(function(t){var n=t.user;return e&&n.id===e.id})),e){if(e.isDm){var t=m.b.getUser(e.id);return(null===t||void 0===t?void 0:t.feed)?Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsx)(t.AvatarComponent,{size:20,style:{marginRight:5}}),h.a.parse(t.feed,null,{minimal:!0})]}):Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsx)(t.AvatarComponent,{size:20,style:{marginRight:5}}),"Message ",null===t||void 0===t?void 0:t.displayName]})}return e.description?Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsx)(d.a,{style:{marginRight:5}}),h.a.parse(e.description,null,{minimal:!0})]}):Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsx)(d.a,{})," Say hi!"]})}return Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsx)(b.a,{})," No group selected."]})}function E(){var e,t;f.b.useForceUpdater(j.a.PAGE_UPDATE),f.b.useForceUpdater(j.a.UPDATE_TYPING_INDICATORS,(function(e){return[e.circleId,e.userId].some((function(e){return window.location.href.includes(e)}))}));var n=null!==(e=v.a.getSelectedGroup())&&void 0!==e?e:{},r=Object.keys(null!==(t=p.a.getTypingUsersForGroup(n.circleId,n.id))&&void 0!==t?t:{});return Object(y.jsxs)("div",{className:Object(j.i)("TypingIndicators",[!!r.length,"Active"]),children:[r.map((function(e,t){return Object(y.jsxs)(o.a.Fragment,{children:[Object(y.jsx)(O.a,{user:m.b.getUser(e),convertToYou:!0}),t!==r.length-1&&Object(y.jsxs)("div",{className:"Comma",children:[", ",t===r.length-2&&"and"]})]},e)})),r.length>1||~r.indexOf(m.b.getLocalUser().id)?" are":" is"," typing..."]})}}).call(this,n(52).setImmediate)},,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(3),a=n.n(r),c=n(62),i=n.n(c),s=n(30);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=n(1);i.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(s.b,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[133,1,2]]]);